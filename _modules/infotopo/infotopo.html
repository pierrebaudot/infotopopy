<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>infotopo.infotopo &#8212; infotopo 0.1.0 documentation</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          infotopo</a>
        <span class="navbar-text navbar-version pull-left"><b>0.1.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../method.html">Method</a></li>
                <li><a href="../../tutorial.html">Tutorial</a></li>
                <li><a href="../../install.html">Install</a></li>
                <li><a href="../../api.html">API</a></li>
                <li><a href="../../auto_examples/index.html">Examples</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><p class="caption"><span class="caption-text">User Guide / Tutorial:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../method.html">Topological Learning</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../method.html#topological-learning-principles">Topological Learning principles</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../method.html#information-complexes">Information Complexes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../method.html#poincare-shannon-machine">Poincaré-Shannon Machine</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../method.html#unsupervised-topological-learning">Unsupervised topological learning</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../method.html#causality-challenge-dataset">Causality challenge dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../method.html#id2">Information Complexes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../method.html#digits-dataset">Digits Dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../method.html#adaptive-computational-complexity">Adaptive computational complexity</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../method.html#id3">Unsupervised topological learning</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial.html">How to Use InfoTopo</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tutorial.html#iris-data">Iris data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../tutorial.html#iris-dataset">Iris dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorial.html#entropy">Entropy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorial.html#mutual-information">Mutual Information</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorial.html#information-networks">Information Networks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorial.html#diabetes-data">Diabetes data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../tutorial.html#diabetes-dataset">Diabetes dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorial.html#id4">Entropy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorial.html#total-correlation">Total correlation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorial.html#id5">Mutual Information</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorial.html#id6">Information Networks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorial.html#mean-information-path">Mean Information path</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorial.html#conditional-transfer-informations">Conditional (transfer) Informations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorial.html#entropy-vs-energy">Entropy Vs. Energy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorial.html#information-distance">Information distance</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../install.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../install.html#standard-installation">Standard installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../install.html#install-the-most-up-to-date-version">Install the most up-to-date version</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <h1>Source code for infotopo.infotopo</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Main class Infotopo.&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">combinations</span><span class="p">,</span> <span class="n">chain</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">LogNorm</span>
<span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="kn">import</span> <span class="nn">heapq</span>
<span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">itemgetter</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>



<div class="viewcode-block" id="Infotopo"><a class="viewcode-back" href="../../generated/infotopo.Infotopo.html#infotopo.Infotopo">[docs]</a><span class="k">class</span> <span class="nc">Infotopo</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Compute the simplicial information cohomology of a set of variable.</span>

<span class="sd">    This class can be used to compute the simplicial information cohomology of</span>
<span class="sd">    a set of variablenotably the joint and conditional entropies, the mutual</span>
<span class="sd">    and conditional mutual information, total correlations, and information</span>
<span class="sd">    paths within the simplicial set.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dimension_max : int | 16</span>
<span class="sd">        Maximum number of random variable (column or dimension) for the</span>
<span class="sd">        exploration of the cohomology and lattice</span>
<span class="sd">    dimension_tot : int | 16</span>
<span class="sd">        Total number of random variable (column or dimension) to consider in</span>
<span class="sd">        the input matrix for analysis (the first columns)</span>
<span class="sd">    sample_size : int | 1000</span>
<span class="sd">        Total number of points (rows or number of trials)  to consider in the</span>
<span class="sd">        input matrix for analysis (the first rows)</span>
<span class="sd">    work_on_transpose : bool | False</span>
<span class="sd">        If True take the transpose of the input matrix (this change column into</span>
<span class="sd">        rows etc.)</span>
<span class="sd">    nb_of_values : int | 9</span>
<span class="sd">        Number of different values for the sampling of each variable (alphabet</span>
<span class="sd">        size)</span>
<span class="sd">    sampling_mode : int | None</span>
<span class="sd">        Define the sampling mode. Use either :</span>

<span class="sd">            * 1 : normalization taking the max and min of each columns</span>
<span class="sd">              (normalization row by columns)</span>
<span class="sd">            * 2 : normalization taking the max and min of the whole matrix</span>
<span class="sd">            * 3 : TO BE DEFINED &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span>
<span class="sd">    deformed_probability_mode : bool | False</span>
<span class="sd">        Mode for the deformed probabilities. Choose either :</span>

<span class="sd">            * True : it will compute the &quot;escort distribution&quot; also called the</span>
<span class="sd">              &quot;deformed probabilities&quot;. p(n,k)= p(k)^n/ (sum(i)p(i)^n, where n</span>
<span class="sd">              is the sample size. :cite:`umarov2008q,bercher2011escort`</span>
<span class="sd">              :cite:`chhabra1989direct,beck1995thermodynamics`</span>
<span class="sd">            * False : it will compute the classical probability, e.g. the ratio</span>
<span class="sd">              of empirical frequencies over total number of observation</span>
<span class="sd">              :cite:`kolomogoroff2013grundbegriffe`</span>

<span class="sd">    supervised_mode : bool | False</span>
<span class="sd">        If True it will consider the lavelvector for supervised learning;</span>
<span class="sd">        if False unsupervised mode</span>
<span class="sd">    forward_computation_mode : bool | False</span>
<span class="sd">        Choose if the computation should be forward :</span>
<span class="sd">            * True : it will compute joint entropies on the simplicial lattice</span>
<span class="sd">              from low dimension to high dimension (co-homological way). For</span>
<span class="sd">              each element of the lattice of random-variable the corresponding</span>
<span class="sd">              joint probability is estimated. This allows to explore only the</span>
<span class="sd">              first low dimensions-rank of the lattice, up to dimension_max</span>
<span class="sd">              (in dimension_tot)</span>
<span class="sd">            * False : it will compute joint entropies on whole  simplicial</span>
<span class="sd">              lattice from high dimension to the marginals (homological way).</span>
<span class="sd">              The joint probability corresponding to all variable is first</span>
<span class="sd">              estimated and then projected on lower dimensions using</span>
<span class="sd">              conditional rule. This explore the whole lattice, and imposes</span>
<span class="sd">              dimension_max = dimension_tot</span>

<span class="sd">    nb_bins_histo : int | 200</span>
<span class="sd">        Number of values used for entropy and mutual information distribution</span>
<span class="sd">        histograms and landscapes.</span>
<span class="sd">    p_value_undersampling : float | 0.05</span>
<span class="sd">        Real in ]0,1[ value of the probability that a box have a single point</span>
<span class="sd">        (e.g. undersampled minimum atomic probability = 1/number of points)</span>
<span class="sd">        over all boxes at a given dimension. It provides a confidence to</span>
<span class="sd">        estimate the undersampling dimenesion Ku above which information</span>
<span class="sd">        etimations shall not be considered.</span>
<span class="sd">    compute_shuffle : bool | False</span>
<span class="sd">        Choose either :</span>
<span class="sd">            * True : it will compute the statictical test of significance of</span>
<span class="sd">              the dependencies (pethel et hah 2014) and make shuffles that</span>
<span class="sd">              preserve the marginal but the destroys the mutual informations</span>
<span class="sd">            * False : no shuffles and test of the mutual information</span>
<span class="sd">              estimations is acheived</span>

<span class="sd">    p_value : float | 0.05</span>
<span class="sd">        Real in ]0,1[ p value of the test of significance of the dependencies</span>
<span class="sd">        estimated by mutual info the H0 hypotheis is the mutual Info</span>
<span class="sd">        distribution does not differ from the distribution of MI with shuffled</span>
<span class="sd">        higher order dependencies</span>
<span class="sd">    nb_of_shuffle : int | 20</span>
<span class="sd">        Number of shuffles computed</span>
<span class="sd">    dim_to_rank : int | 2</span>
<span class="sd">        Chosen dimension k to rank the k-tuples as a function information</span>
<span class="sd">        functions values.</span>
<span class="sd">    number_of_max_val : int | 2</span>
<span class="sd">        Number of the first k-tuples with maximum or minimum value to retrieve</span>
<span class="sd">        in a dictionary and to plot the corresponding data points k-subspace.</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="Infotopo.__init__"><a class="viewcode-back" href="../../generated/infotopo.Infotopo.html#infotopo.Infotopo.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dimension_max</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">dimension_tot</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">sample_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
                 <span class="n">work_on_transpose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">nb_of_values</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">sampling_mode</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                 <span class="n">deformed_probability_mode</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">supervised_mode</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">forward_computation_mode</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">nb_bins_histo</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
                 <span class="n">p_value_undersampling</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">compute_shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">p_value</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">nb_of_shuffle</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">dim_to_rank</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                 <span class="n">number_of_max_val</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Init.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span> <span class="o">=</span> <span class="n">dimension_max</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dimension_tot</span> <span class="o">=</span> <span class="n">dimension_tot</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sample_size</span> <span class="o">=</span> <span class="n">sample_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">work_on_transpose</span> <span class="o">=</span> <span class="n">work_on_transpose</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nb_of_values</span> <span class="o">=</span> <span class="n">nb_of_values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sampling_mode</span> <span class="o">=</span> <span class="n">sampling_mode</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deformed_probability_mode</span> <span class="o">=</span> <span class="n">deformed_probability_mode</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">supervised_mode</span> <span class="o">=</span> <span class="n">supervised_mode</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forward_computation_mode</span> <span class="o">=</span> <span class="n">forward_computation_mode</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nb_bins_histo</span> <span class="o">=</span> <span class="n">nb_bins_histo</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p_value_undersampling</span> <span class="o">=</span> <span class="n">p_value_undersampling</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compute_shuffle</span> <span class="o">=</span> <span class="n">compute_shuffle</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p_value</span> <span class="o">=</span> <span class="n">p_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nb_of_shuffle</span> <span class="o">=</span> <span class="n">nb_of_shuffle</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dim_to_rank</span> <span class="o">=</span> <span class="n">dim_to_rank</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">number_of_max_val</span> <span class="o">=</span> <span class="n">number_of_max_val</span></div>

    <span class="k">def</span> <span class="nf">_validate_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check input parameters.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;dimension_max must be greater than 1&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension_tot</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;dimension_tot must be greater than 1&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_size</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;sample_size must be greater than 1&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nb_of_values</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;nb_of_values must be greater than 1&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension_tot</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;dimension_tot must be greater or equal than &quot;</span>
                             <span class="s2">&quot;dimension_max&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">forward_computation_mode</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension_tot</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;if forward_computation_mode then dimension_&quot;</span>
                                 <span class="s2">&quot;max must be equal to dimension_tot&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nb_bins_histo</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;nb_bins_histo must be greater than 1&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_value</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;p_value must be in between 0 and 1&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="mi">0</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_value</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;p_value must be in between 0 and 1&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_value_undersampling</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;self.p_value_undersampling must be in between &quot;</span>
                             <span class="s2">&quot;0 and 1&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="mi">0</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_value_undersampling</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;self.p_value_undersampling must be in between &quot;</span>
                             <span class="s2">&quot;0 and 1&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_shuffle</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nb_of_shuffle</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim_to_rank</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;dim_to_rank must be smaller than dimension_max&quot;</span><span class="p">)</span>

    <span class="c1"># -------------------------------------------------------------------------</span>
    <span class="c1"># -------------------------------------------------------------------------</span>
    <span class="c1">#                           RESAMPLE DATA MATRIX</span>
    <span class="c1"># -------------------------------------------------------------------------</span>
    <span class="c1"># -------------------------------------------------------------------------</span>

    <span class="k">def</span> <span class="nf">_resample_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_matrix</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Resample input data to nb_of_values for each variables-dimension.</span>

<span class="sd">        sampling_mode : int | None</span>
<span class="sd">            Define the sampling mode. Use either :</span>

<span class="sd">                * 1 : normalization taking the max and min of each columns</span>
<span class="sd">                  (normalization row by columns)</span>
<span class="sd">                * 2 : normalization taking the max and min of the whole matrix</span>
<span class="sd">                * 3 : TO BE DEFINED &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span>
<span class="sd">        TO BE DONE: use panda dataframe .resample to do it...</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">work_on_transpose</span><span class="p">:</span>
            <span class="n">data_matrix</span> <span class="o">=</span> <span class="n">data_matrix</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        <span class="c1"># find the Min and the Max of the matrix:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_mode</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">min_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">data_matrix</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">max_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">data_matrix</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_mode</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">min_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">data_matrix</span><span class="p">)</span>
            <span class="n">max_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">data_matrix</span><span class="p">)</span>
        <span class="c1"># create the amplitude matrix</span>
        <span class="n">ampl_matrix</span> <span class="o">=</span> <span class="n">max_matrix</span> <span class="o">-</span> <span class="n">min_matrix</span>
        <span class="c1"># WE RESCALE THE MATRICE AND SAMPLE IT into  nb_of_values</span>
        <span class="n">data_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(((</span><span class="n">data_matrix</span><span class="o">-</span><span class="n">min_matrix</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nb_of_values</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">ampl_matrix</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">data_matrix</span>

    <span class="c1"># -------------------------------------------------------------------------</span>
    <span class="c1"># -------------------------------------------------------------------------</span>
    <span class="c1">#                   COMPUTE PROBABILITY DISTRIBUTIONS</span>
    <span class="c1"># -------------------------------------------------------------------------</span>
    <span class="c1"># -------------------------------------------------------------------------</span>

    <span class="k">def</span> <span class="nf">_compute_probability</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_matrix</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compute the joint probability distribution of all variables.</span>

<span class="sd">        To avoid to have to explore all  possible  probability (sparse data)</span>
<span class="sd">        we encode probability as dictionanry, each existing probability has a</span>
<span class="sd">        key</span>

<span class="sd">        TO DO: import the new simpler function that compute probability and</span>
<span class="sd">        compare</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">probability</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># in case the data_matrix has a single variable-dimension reshape the</span>
        <span class="c1"># vector to matrix</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> <span class="p">:</span>
            <span class="n">data_matrix</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">data_matrix</span><span class="p">,(</span><span class="n">data_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">data_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">x</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">data_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                <span class="n">x</span><span class="o">=</span> <span class="n">x</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">data_matrix</span><span class="p">[</span><span class="n">row</span><span class="p">,</span><span class="n">col</span><span class="p">])))</span>
            <span class="n">probability</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">=</span><span class="n">probability</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
        <span class="n">Nbtot</span><span class="o">=</span><span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">probability</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">Nbtot</span><span class="o">=</span><span class="n">Nbtot</span><span class="o">+</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="ow">in</span> <span class="n">probability</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
               <span class="n">probability</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">j</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">Nbtot</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">probability</span>

    <span class="c1"># -------------------------------------------------------------------------</span>
    <span class="c1"># -------------------------------------------------------------------------</span>
    <span class="c1">#       COMPUTE DEFORMED PROBABILITY AT ALL ORDERS On SET OF SUBSETS</span>
    <span class="c1"># -------------------------------------------------------------------------</span>
    <span class="c1"># -------------------------------------------------------------------------</span>

    <span class="k">def</span> <span class="nf">_compute_deformed_probability</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_matrix</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compute the &quot;escort distribution&quot; (&quot;deformed probabilities&quot;).</span>

<span class="sd">        deformed_probability_mode : bool | False</span>
<span class="sd">            Mode for the deformed probabilities. Choose either :</span>

<span class="sd">                * True : it will compute the &quot;escort distribution&quot; also called</span>
<span class="sd">                  the &quot;deformed probabilities&quot;. p(n,k)= p(k)^n/ (sum(i)p(i)^n,</span>
<span class="sd">                  where n is the sample size. :cite:`umarov2008q,</span>
<span class="sd">                  bercher2011escort` :cite:`chhabra1989direct,</span>
<span class="sd">                  beck1995thermodynamics`</span>
<span class="sd">                * False : it will compute the classical probability, e.g. the</span>
<span class="sd">                  ratio of empirical frequencies over total number of</span>
<span class="sd">                  observation :cite:`kolomogoroff2013grundbegriffe`</span>
<span class="sd">        TO DO: import the new simpler function that compute probability and</span>
<span class="sd">        compare and use optimal power computation:</span>
<span class="sd">        https://stackoverflow.com/questions/101439/the-most-efficient-way-to-</span>
<span class="sd">        implement-an-integer-based-power-function-powint-int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">probability</span><span class="o">=</span><span class="p">{}</span>
        <span class="c1"># in case the data_matrix has a single variable-dimension reshape the</span>
        <span class="c1"># vector to matrix</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> <span class="p">:</span>
            <span class="n">data_matrix</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">data_matrix</span><span class="p">,(</span><span class="n">data_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">sample_size_data</span><span class="o">=</span> <span class="n">data_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">data_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">x</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">data_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                <span class="n">x</span><span class="o">=</span> <span class="n">x</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">data_matrix</span><span class="p">[</span><span class="n">row</span><span class="p">,</span><span class="n">col</span><span class="p">])))</span>
            <span class="n">probability</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">=</span><span class="n">probability</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
        <span class="n">Nbtot</span><span class="o">=</span><span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">probability</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">Nbtot</span><span class="o">=</span><span class="n">Nbtot</span><span class="o">+</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="ow">in</span> <span class="n">probability</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
               <span class="n">probability</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">j</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">Nbtot</span><span class="p">)</span>
        <span class="n">Nbtot_bis</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">sum_prob</span><span class="o">=</span><span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">probability</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">Nbtot_bis</span><span class="o">=</span><span class="n">Nbtot_bis</span><span class="o">+</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="n">sample_size_data</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="ow">in</span> <span class="n">probability</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
               <span class="n">probability</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">j</span><span class="o">**</span><span class="n">sample_size_data</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">Nbtot_bis</span><span class="p">)</span>
               <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;probability[i]&quot;</span><span class="p">,</span><span class="n">probability</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
               <span class="n">sum_prob</span><span class="o">=</span><span class="n">sum_prob</span><span class="o">+</span><span class="n">probability</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;sum_prob&quot;</span><span class="p">,</span><span class="n">sum_prob</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">probability</span>

    <span class="c1"># -------------------------------------------------------------------------</span>
    <span class="c1"># -------------------------------------------------------------------------</span>
    <span class="c1">#         SOME FUNCTIONS USEFULLS AT ALL ORDERS On SET OF SUBSETS</span>
    <span class="c1"># -------------------------------------------------------------------------</span>
    <span class="c1"># -------------------------------------------------------------------------</span>
    <span class="k">def</span> <span class="nf">_information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Entropy Fonction.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">x</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_factorial</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Fonction factorielle.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_factorial</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_binomial</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span><span class="n">k</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Fonction coeficient binomial.</span>

<span class="sd">        Nombre de combinaison de k elements dans [1,..,n]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_factorial</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_factorial</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_factorial</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">k</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_decode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">combinat</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Combinatoire (combinat) de k variables dans n codée par x dans</span>
<span class="sd">        combinatoire. Les combinaisons de k élements dans [1,..,n] sont en</span>
<span class="sd">        bijection avec les entiers x de [0,...,n!/(k!(n-k)!)-1]. Attention</span>
<span class="sd">        numerotation part de 0.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_binomial</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_decode</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">combinat</span><span class="p">)</span>
            <span class="n">combinat</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_decode</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">b</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">combinat</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_decode_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">order</span><span class="p">,</span> <span class="n">combinat</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Combinatoire (combinat) et l&#39;ordre k associé au code x x varie de 0</span>
<span class="sd">        à (2^n)-1, les n premiers x code pour 1 parmis n les suivants codent</span>
<span class="sd">        pour 2 parmis n etc... jusquà x=(2^n)-1 qui code pour n parmis n les</span>
<span class="sd">        combinaisons de k élements dans [1,..,n] sont en bijection avec les</span>
<span class="sd">        entiers x de [0,...,n!/(k!(n-k)!)-1].</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sumtot</span><span class="o">=</span><span class="n">n</span>
        <span class="n">order</span><span class="o">=</span><span class="mi">1</span>
        <span class="n">Code_order</span><span class="o">=</span><span class="n">x</span>
        <span class="k">while</span> <span class="n">x</span><span class="o">&gt;=</span><span class="n">sumtot</span><span class="p">:</span>
            <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="o">+</span><span class="mi">1</span>
            <span class="n">sumtot</span><span class="o">=</span><span class="n">sumtot</span><span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_binomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">order</span><span class="p">)</span>
            <span class="n">Code_order</span><span class="o">=</span><span class="n">Code_order</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">_binomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">order</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">k</span><span class="o">=</span><span class="n">order</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_decode</span><span class="p">(</span><span class="n">Code_order</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">combinat</span><span class="p">)</span>


    <span class="c1"># -------------------------------------------------------------------------</span>
    <span class="c1"># -------------------------------------------------------------------------</span>
    <span class="c1">#                             ENTROPY METHODS</span>
    <span class="c1"># -------------------------------------------------------------------------</span>
    <span class="c1"># -------------------------------------------------------------------------</span>

    <span class="k">def</span> <span class="nf">_compute_entropy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">probability</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compute entropy.&quot;&quot;&quot;</span>
        <span class="n">ntuple</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">ntuple1_input</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">Nentropie</span><span class="o">=</span><span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_decode</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_tot</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="p">,</span><span class="n">ntuple1_input</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(asctime)s</span><span class="s1"> : </span><span class="si">%(levelname)s</span><span class="s1"> : </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
        <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;compute Proba-Entropy&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Percent of tuples processed : 0&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,(</span><span class="mi">2</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">&gt;</span> <span class="mi">10</span> <span class="p">:</span>
                 <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">%</span> <span class="nb">int</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                     <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;PROGRESS: at percent #</span><span class="si">%i</span><span class="s2">&quot;</span>  <span class="o">%</span> <span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="p">)))</span>
            <span class="n">ntuple</span><span class="o">=</span><span class="p">[]</span>
            <span class="n">orderInf</span><span class="o">=</span><span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_decode_all</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="p">,</span><span class="n">orderInf</span><span class="p">,</span><span class="n">ntuple</span><span class="p">)</span>
            <span class="n">tuple_code</span><span class="o">=</span><span class="p">()</span>
            <span class="n">probability2</span><span class="o">=</span><span class="p">{}</span>
            <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">ntuple</span><span class="p">)):</span>
                <span class="n">concat</span><span class="o">=</span><span class="p">()</span>
                <span class="n">concat</span><span class="o">=</span><span class="p">(</span><span class="n">ntuple1_input</span><span class="p">[</span><span class="n">ntuple</span><span class="p">[</span><span class="n">z</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">],)</span>
                <span class="n">tuple_code</span><span class="o">=</span><span class="n">tuple_code</span><span class="o">+</span><span class="n">concat</span>
            <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="n">probability</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">Codeproba</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
                <span class="n">length</span><span class="o">=</span><span class="mi">0</span>
                <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">ntuple</span><span class="p">[</span><span class="n">length</span><span class="p">]</span><span class="o">!=</span><span class="n">w</span><span class="p">:</span>
                        <span class="n">Codeproba</span><span class="o">=</span><span class="n">Codeproba</span><span class="o">+</span><span class="s1">&#39;0&#39;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">Codeproba</span><span class="o">=</span><span class="n">Codeproba</span><span class="o">+</span><span class="n">x</span><span class="p">[</span><span class="n">ntuple</span><span class="p">[</span><span class="n">length</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">ntuple</span><span class="p">[</span><span class="n">length</span><span class="p">]]</span>
                        <span class="k">if</span> <span class="n">length</span><span class="o">&lt;</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ntuple</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                            <span class="n">length</span><span class="o">=</span><span class="n">length</span><span class="o">+</span><span class="mi">1</span>
                <span class="n">probability2</span><span class="p">[</span><span class="n">Codeproba</span><span class="p">]</span><span class="o">=</span><span class="n">probability2</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Codeproba</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="n">probability</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">Nentropie</span><span class="p">[</span><span class="n">tuple_code</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
<span class="c1"># to change: the program computes too many times the entropy:  m*2**n instead of</span>
            <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">probability2</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">Nentropie</span><span class="p">[</span><span class="n">tuple_code</span><span class="p">]</span><span class="o">=</span><span class="n">Nentropie</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">tuple_code</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_information</span><span class="p">(</span><span class="n">probability2</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
            <span class="n">probability2</span><span class="o">=</span><span class="p">{}</span>
            <span class="n">probability2</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="k">del</span><span class="p">(</span><span class="n">probability2</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">Nentropie</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_compute_forward_entropies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_matrix</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compute forward-co probability and entropies.&quot;&quot;&quot;</span>
        <span class="n">Nentropie</span><span class="o">=</span><span class="p">{}</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(asctime)s</span><span class="s1"> : </span><span class="si">%(levelname)s</span><span class="s1"> : </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
        <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;compute Proba-Entropy&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Percent of tuples processed : 0&quot;</span><span class="p">)</span>
        <span class="c1">################  Create the list of all subsets of i elements in n=dim_tot for all i&lt;dimension_max+1</span>
        <span class="n">allsubsets</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">n</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">combinations</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="n">ni</span><span class="p">)</span> <span class="k">for</span> <span class="n">ni</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">+</span><span class="mi">1</span><span class="p">)]))</span>
        <span class="n">list_tuples</span><span class="o">=</span><span class="n">allsubsets</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_tot</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">list_tuples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1">################  Count the number all subsets of i elements in n=dim_tot for all i&lt;dimension_max+1</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension_tot</span> <span class="p">:</span>
            <span class="n">tot_numb</span><span class="o">=</span><span class="mi">0</span>
            <span class="k">for</span>  <span class="n">xxx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">tot_numb</span><span class="o">=</span><span class="n">tot_numb</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_binomial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_tot</span><span class="p">,</span><span class="n">xxx</span><span class="p">)</span>
        <span class="n">counter</span><span class="o">=</span><span class="mi">0</span>
        <span class="k">for</span> <span class="n">tuple_var</span> <span class="ow">in</span> <span class="n">list_tuples</span><span class="p">:</span>
            <span class="c1">################  create a counter to display the advancement of the script (this is the computationaly costly part)</span>
            <span class="n">counter</span><span class="o">=</span><span class="n">counter</span><span class="o">+</span><span class="mi">1</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension_tot</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">counter</span> <span class="o">%</span> <span class="nb">int</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;PROGRESS: at percent #</span><span class="si">%i</span><span class="s2">&quot;</span>  <span class="o">%</span> <span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">counter</span><span class="o">/</span><span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="p">)))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">counter</span> <span class="o">%</span> <span class="nb">int</span><span class="p">(</span><span class="n">tot_numb</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;PROGRESS: at percent #</span><span class="si">%i</span><span class="s2">&quot;</span>  <span class="o">%</span> <span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">counter</span><span class="o">/</span><span class="n">tot_numb</span><span class="p">))</span>
            <span class="c1">################  create a sub-matrix of data input for all subsets of variables</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">tuple_var</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">x</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                    <span class="n">matrix_temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">data_matrix</span><span class="p">[:,</span><span class="n">tuple_var</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">],(</span><span class="n">data_matrix</span><span class="p">[:,</span><span class="n">tuple_var</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">matrix_temp</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">matrix_temp</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">data_matrix</span><span class="p">[:,</span><span class="n">tuple_var</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">],(</span><span class="n">data_matrix</span><span class="p">[:,</span><span class="n">tuple_var</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">))),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="c1">################  compute probability and entropy for each submatrix</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">deformed_probability_mode</span><span class="p">:</span>
                <span class="n">probability</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_compute_deformed_probability</span><span class="p">(</span><span class="n">matrix_temp</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">probability</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_probability</span><span class="p">(</span><span class="n">matrix_temp</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">probability</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">Nentropie</span><span class="p">[</span><span class="n">tuple_var</span><span class="p">]</span><span class="o">=</span><span class="n">Nentropie</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">tuple_var</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_information</span><span class="p">(</span><span class="n">probability</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
        <span class="k">return</span>  <span class="n">Nentropie</span>


    <span class="k">def</span> <span class="nf">simplicial_entropies_decomposition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_matrix</span><span class="p">)</span> <span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_parameters</span><span class="p">()</span>
        <span class="n">data_matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resample_matrix</span><span class="p">(</span><span class="n">data_matrix</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">forward_computation_mode</span><span class="p">:</span>
            <span class="n">Nentropie</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_forward_entropies</span><span class="p">(</span><span class="n">data_matrix</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">deformed_probability_mode</span><span class="p">:</span>
                <span class="n">probability</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_compute_deformed_probability</span><span class="p">(</span><span class="n">data_matrix</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">probability</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_probability</span><span class="p">(</span><span class="n">data_matrix</span><span class="p">)</span>
            <span class="n">Nentropie</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_entropy</span><span class="p">(</span><span class="n">probability</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Nentropie</span>


    <span class="c1"># -------------------------------------------------------------------------</span>
    <span class="c1"># -------------------------------------------------------------------------</span>
    <span class="c1"># FUNCTION BINOMIAL_SUBGROUPS COMBINAT GIVES ALL BINOMIAL K SUBGROUP OF A</span>
    <span class="c1">#                                 GROUP</span>
    <span class="c1"># -------------------------------------------------------------------------</span>
    <span class="c1"># -------------------------------------------------------------------------</span>

    <span class="k">def</span> <span class="nf">simplicial_infomut_decomposition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Nentropie_input</span><span class="p">):</span>
        <span class="n">Ninfomut</span><span class="o">=</span><span class="p">{}</span>
        <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">Nentropie_input</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">subset</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
                    <span class="n">Ninfomut</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">=</span><span class="n">Ninfomut</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span> <span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">subset</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">Nentropie_input</span><span class="p">[</span><span class="n">subset</span><span class="p">]</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">Ninfomut</span><span class="p">)</span>

    <span class="c1"># &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span>
    <span class="c1"># &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span>
    <span class="c1"># &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span>
    <span class="c1">#                                PLOT (to cut)</span>
    <span class="c1"># &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span>
    <span class="c1"># &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span>
    <span class="c1"># &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span>

<span class="c1">#########################################################################</span>
<span class="c1">#########################################################################</span>
<span class="c1">######             Histogramms ENTROPY          #########################</span>
<span class="c1">######           &amp;  ENTROPY LANDSCAPES          #########################</span>
<span class="c1">######                FIGURE 4                  #########################</span>
<span class="c1">#########################################################################</span>
<span class="c1">#########################################################################</span>

    <span class="k">def</span> <span class="nf">entropy_simplicial_lanscape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Nentropie</span><span class="p">):</span>
        <span class="n">num_fig</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num_fig</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
        <span class="n">moyenne</span><span class="o">=</span><span class="p">{}</span>
        <span class="n">nbpoint</span><span class="o">=</span><span class="p">{}</span>
        <span class="n">matrix_distrib_info</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="n">maxima_tot</span><span class="o">=-</span><span class="mf">1000000.00</span>
        <span class="n">minima_tot</span><span class="o">=</span><span class="mf">1000000.00</span>
        <span class="n">ListEntropyordre</span><span class="o">=</span><span class="p">{}</span>
        <span class="n">undersampling_percent</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>


        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">ListEntropyordre</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">[]</span>

        <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">Nentropie</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">ListEntropyordre</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
            <span class="n">moyenne</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span><span class="o">=</span><span class="n">moyenne</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="n">y</span>
            <span class="n">nbpoint</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span><span class="o">=</span><span class="n">nbpoint</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
            <span class="k">if</span> <span class="n">y</span><span class="o">&gt;</span><span class="n">maxima_tot</span><span class="p">:</span>
                <span class="n">maxima_tot</span><span class="o">=</span><span class="n">y</span>
            <span class="k">if</span> <span class="n">y</span><span class="o">&lt;</span><span class="n">minima_tot</span><span class="p">:</span>
                <span class="n">minima_tot</span><span class="o">=</span><span class="n">y</span>
        <span class="n">delta_entropy_histo</span> <span class="o">=</span> <span class="p">(</span><span class="n">maxima_tot</span><span class="o">-</span><span class="n">minima_tot</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">nb_bins_histo</span>

        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">&lt;=</span><span class="mi">9</span> <span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">&lt;=</span><span class="mi">16</span> <span class="p">:</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
                <span class="k">else</span> <span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">&lt;=</span><span class="mi">20</span> <span class="p">:</span>
                        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">:</span>
                        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
 <span class="c1"># compute the Ku undersampling bound</span>
            <span class="n">nb_undersampling_point</span><span class="o">=</span><span class="mi">0</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">ListEntropyordre</span><span class="p">[</span><span class="n">a</span><span class="p">])):</span>
 <span class="c1">#               if ListEntropyordre[a][x] &gt;= ((math.log(self.sample_size)/math.log(2))-0.00000001):</span>
                <span class="k">if</span> <span class="n">ListEntropyordre</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="p">((</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sample_size</span><span class="p">)</span><span class="o">/</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">-</span><span class="n">delta_entropy_histo</span><span class="p">):</span>
                    <span class="n">nb_undersampling_point</span><span class="o">=</span><span class="n">nb_undersampling_point</span><span class="o">+</span><span class="mi">1</span>
                    <span class="k">if</span> <span class="n">a</span> <span class="o">==</span><span class="mi">1</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">ListEntropyordre</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">x</span><span class="p">])</span>
            <span class="n">percent_undersampled</span> <span class="o">=</span>  <span class="mi">100</span><span class="o">*</span><span class="n">nb_undersampling_point</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">_binomial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
            <span class="n">undersampling_percent</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">undersampling_percent</span><span class="p">,</span> <span class="n">percent_undersampled</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;undersampling percent in dim &#39;</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="s1">&#39; = &#39;</span><span class="p">,</span> <span class="n">percent_undersampled</span> <span class="p">)</span>
            <span class="n">ListEntropyordre</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">minima_tot</span><span class="o">-</span><span class="mf">0.1</span><span class="p">)</span>
            <span class="n">ListEntropyordre</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">maxima_tot</span><span class="o">+</span><span class="mf">0.1</span><span class="p">)</span>
            <span class="n">n</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">patches</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ListEntropyordre</span><span class="p">[</span><span class="n">a</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">nb_bins_histo</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="n">minima_tot</span><span class="p">,</span> <span class="n">maxima_tot</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; dist&#39;</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">a</span><span class="o">==</span><span class="mi">1</span> <span class="p">:</span>
                <span class="n">matrix_distrib_info</span><span class="o">=</span><span class="n">n</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">matrix_distrib_info</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">matrix_distrib_info</span><span class="p">,</span><span class="n">n</span><span class="p">]</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">boolean_test</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">undersampling_dim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span>
        <span class="k">for</span> <span class="n">xxxx</span> <span class="ow">in</span>  <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="p">)</span> <span class="p">:</span>
            <span class="k">if</span> <span class="n">undersampling_percent</span><span class="p">[</span><span class="n">xxxx</span><span class="p">]</span> <span class="o">&gt;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p_value_undersampling</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span> <span class="ow">and</span> <span class="n">boolean_test</span><span class="p">:</span>
                <span class="n">undersampling_dim</span> <span class="o">=</span> <span class="n">xxxx</span><span class="o">+</span><span class="mi">1</span>
                <span class="n">boolean_test</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;the undersampling dimension is &#39;</span><span class="p">,</span> <span class="n">undersampling_dim</span><span class="p">,</span> <span class="s1">&#39;with self.p_value_undersampling&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p_value_undersampling</span><span class="p">)</span>

        <span class="n">num_fig</span><span class="o">=</span><span class="n">num_fig</span><span class="o">+</span><span class="mi">1</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num_fig</span><span class="p">)</span>
        <span class="n">abssice_degree</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">abssice_degree</span><span class="p">,</span><span class="n">undersampling_percent</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;percent of undersampled points&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;Undersampling dimension (p&gt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p_value_undersampling</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;), ku=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">undersampling_dim</span><span class="p">)))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;dimension&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">num_fig</span><span class="o">=</span><span class="n">num_fig</span><span class="o">+</span><span class="mi">1</span>
        <span class="n">fig_entropylandscape</span> <span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num_fig</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
        <span class="n">matrix_distrib_info</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">matrix_distrib_info</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">matrix_distrib_info</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="p">,</span><span class="n">minima_tot</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="n">maxima_tot</span><span class="o">+</span><span class="mf">0.1</span><span class="p">],</span> <span class="n">norm</span><span class="o">=</span><span class="n">LogNorm</span><span class="p">(),</span> <span class="n">fignum</span><span class="o">=</span> <span class="n">num_fig</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="p">,</span><span class="n">minima_tot</span><span class="p">,</span><span class="n">maxima_tot</span><span class="p">])</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;# of tuples&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">270</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;dimension&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Hk value (bits)&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Hk landscape&#39;</span><span class="p">)</span>
        <span class="n">fig_entropylandscape</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="c1">#########################################################################</span>
<span class="c1">#########################################################################</span>
<span class="c1">######      Histogramms MUTUAL INFORMATION      #########################</span>
<span class="c1">######           &amp;  INFOMUT LANDSCAPES          #########################</span>
<span class="c1">#########################################################################</span>
<span class="c1">#########################################################################</span>
    <span class="k">def</span> <span class="nf">mutual_info_simplicial_lanscape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Ninfomut</span><span class="p">)</span> <span class="p">:</span>
        <span class="n">num_fig</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">matrix_distrib_infomut</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<span class="c1">#######################################################</span>
<span class="c1">#   COMPUTE THE LIST OF INFOMUT VALUES FOR EACH DEGREE</span>
<span class="c1"># Display every Histo with its own scales:</span>
<span class="c1">#######################################################</span>
<span class="c1"># Compute the list of Infomut at each degree</span>
        <span class="n">ListInfomutordre</span><span class="o">=</span><span class="p">{}</span>
        <span class="n">maxima_tot</span><span class="o">=-</span><span class="mf">1000000.00</span>
        <span class="n">minima_tot</span><span class="o">=</span><span class="mf">1000000.00</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">ListInfomutordre</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">[]</span>

        <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">Ninfomut</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">ListInfomutordre</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">y</span><span class="o">&gt;</span><span class="n">maxima_tot</span><span class="p">:</span>
                <span class="n">maxima_tot</span><span class="o">=</span><span class="n">y</span>
            <span class="k">if</span> <span class="n">y</span><span class="o">&lt;</span><span class="n">minima_tot</span><span class="p">:</span>
                <span class="n">minima_tot</span><span class="o">=</span><span class="n">y</span>

<span class="c1"># Compute the list of Infomut at each degree for each SHUFFLE and sums the distributions</span>
<span class="c1"># (we sum the districbution because the original n-shuffles vectors would be too big )</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_shuffle</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">hist_sum_SHUFFLE</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">hist_sum_SHUFFLE</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">=</span><span class="p">[]</span>

            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nb_of_shuffle</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;k=&#39;</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
                <span class="n">name_object</span><span class="o">=</span> <span class="s1">&#39;INFOMUT&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
                <span class="n">Ninfomut</span> <span class="o">=</span> <span class="n">load_obj</span><span class="p">(</span><span class="n">name_object</span><span class="p">)</span>
                <span class="n">ListInfomutordreSHUFFLE</span><span class="o">=</span><span class="p">{}</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                    <span class="n">ListInfomutordreSHUFFLE</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">[]</span>
                <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">Ninfomut</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">ListInfomutordreSHUFFLE</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">y</span><span class="o">&gt;</span><span class="n">maxima_tot</span><span class="p">:</span>
                        <span class="n">maxima_tot</span><span class="o">=</span><span class="n">y</span>
                    <span class="k">if</span> <span class="n">y</span><span class="o">&lt;</span><span class="n">minima_tot</span><span class="p">:</span>
                        <span class="n">minima_tot</span><span class="o">=</span><span class="n">y</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                    <span class="n">nSHUFFLE</span><span class="p">,</span><span class="n">bin_edgesSHUFFLE</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">ListInfomutordreSHUFFLE</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">nb_bins_histo</span><span class="p">,</span> <span class="p">(</span><span class="n">minima_tot</span><span class="p">,</span><span class="n">maxima_tot</span><span class="p">))</span>
                    <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">:</span>
                        <span class="n">hist_sum_SHUFFLE</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">nSHUFFLE</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">hist_sum_SHUFFLE</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="n">hist_sum_SHUFFLE</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">nSHUFFLE</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">ListInfomutordreSHUFFLE</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
                <span class="k">del</span><span class="p">(</span><span class="n">ListInfomutordreSHUFFLE</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">hist_sum_SHUFFLE</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([[</span><span class="mi">0</span><span class="p">],</span><span class="n">hist_sum_SHUFFLE</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">&lt;</span><span class="mi">9</span> <span class="p">:</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
                <span class="k">else</span> <span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">&lt;=</span><span class="mi">16</span> <span class="p">:</span>
                        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">:</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">&lt;=</span><span class="mi">20</span> <span class="p">:</span>
                            <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
                        <span class="k">else</span> <span class="p">:</span>
                            <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bin_edgesSHUFFLE</span><span class="p">,</span><span class="n">hist_sum_SHUFFLE</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="n">minima_tot</span><span class="p">,</span> <span class="n">maxima_tot</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">hist_sum_SHUFFLE</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>
                <span class="n">num_fig</span><span class="o">=</span><span class="n">num_fig</span><span class="o">+</span><span class="mi">1</span>
<span class="c1">#   COMPUTE THE HISTOGRAMS OF THE LIST OF INFOMUT VALUES FOR EACH DEGREE</span>
<span class="c1">#   If shuffle is true it also compute the signifiance test against independence null hypothesis</span>

        <span class="n">fig_Histo_infomut</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num_fig</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_shuffle</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">low_signif_bound</span><span class="o">=</span><span class="p">{}</span>
            <span class="n">high_signif_bound</span><span class="o">=</span><span class="p">{}</span>
            <span class="n">lign_signif</span><span class="o">=</span><span class="p">{}</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">&lt;</span><span class="mi">9</span> <span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">&lt;=</span><span class="mi">16</span> <span class="p">:</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
                <span class="k">else</span> <span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">&lt;=</span><span class="mi">20</span> <span class="p">:</span>
                        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">:</span>
                        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
            <span class="n">ListInfomutordre</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">minima_tot</span><span class="o">-</span><span class="mf">0.1</span><span class="p">)</span>
            <span class="n">ListInfomutordre</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">maxima_tot</span><span class="o">+</span><span class="mf">0.1</span><span class="p">)</span>
            <span class="n">n</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">patches</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ListInfomutordre</span><span class="p">[</span><span class="n">a</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">nb_bins_histo</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_shuffle</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bin_edgesSHUFFLE</span><span class="p">,</span><span class="n">hist_sum_SHUFFLE</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">nb_of_shuffle</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
                <span class="n">cumul</span><span class="o">=</span><span class="mi">0</span>
                <span class="n">first_signif</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">second_signif</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">lign_signif</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">=</span><span class="p">[]</span>
                <span class="n">lign_signif</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">hist_sum_SHUFFLE</span><span class="p">[</span><span class="n">a</span><span class="p">])</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">hist_sum_SHUFFLE</span><span class="p">[</span><span class="n">a</span><span class="p">])):</span>
                    <span class="n">cumul</span><span class="o">=</span><span class="n">cumul</span><span class="o">+</span><span class="n">hist_sum_SHUFFLE</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">x</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">first_signif</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">cumul</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="n">binomial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="p">,</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">nb_of_shuffle</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">p_value</span><span class="p">):</span>
                            <span class="n">low_signif_bound</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">bin_edgesSHUFFLE</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
                            <span class="n">lign_signif</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span><span class="n">hist_sum_SHUFFLE</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
                            <span class="n">first_signif</span> <span class="o">=</span> <span class="kc">False</span>
                            <span class="n">second_signif</span> <span class="o">=</span> <span class="kc">True</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;low_signif_bound in dim&#39;</span><span class="p">,</span><span class="n">a</span><span class="p">,</span> <span class="s1">&#39; = &#39;</span><span class="p">,</span>  <span class="n">low_signif_bound</span><span class="p">[</span><span class="n">a</span><span class="p">])</span>
                    <span class="k">if</span> <span class="n">second_signif</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">cumul</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="n">binomial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="p">,</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">nb_of_shuffle</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">p_value</span><span class="p">)):</span>
                            <span class="n">high_signif_bound</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">bin_edgesSHUFFLE</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
                            <span class="n">lign_signif</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span><span class="n">hist_sum_SHUFFLE</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
                            <span class="n">second_signif</span> <span class="o">=</span> <span class="kc">False</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;high_signif_bound in dim&#39;</span><span class="p">,</span><span class="n">a</span><span class="p">,</span> <span class="s1">&#39; = &#39;</span><span class="p">,</span>  <span class="n">high_signif_bound</span><span class="p">[</span><span class="n">a</span><span class="p">])</span>
                <span class="n">nb_of_signif_low</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">nb_of_signif_high</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">ListInfomutordre</span><span class="p">[</span><span class="n">a</span><span class="p">])):</span>
                    <span class="k">if</span> <span class="n">ListInfomutordre</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">low_signif_bound</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="p">:</span>
                        <span class="n">nb_of_signif_low</span> <span class="o">=</span> <span class="n">nb_of_signif_low</span><span class="o">+</span><span class="mi">1</span>
                    <span class="k">if</span> <span class="n">ListInfomutordre</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">high_signif_bound</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="p">:</span>
                        <span class="n">nb_of_signif_high</span> <span class="o">=</span> <span class="n">nb_of_signif_high</span><span class="o">+</span><span class="mi">1</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;nb_of_signif_low in dim&#39;</span><span class="p">,</span><span class="n">a</span><span class="p">,</span> <span class="s1">&#39; = &#39;</span><span class="p">,</span>  <span class="n">nb_of_signif_low</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;nb_of_signif_high in dim&#39;</span><span class="p">,</span><span class="n">a</span><span class="p">,</span> <span class="s1">&#39; = &#39;</span><span class="p">,</span>  <span class="n">nb_of_signif_high</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bin_edgesSHUFFLE</span><span class="p">,</span><span class="n">lign_signif</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">nb_of_shuffle</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="n">minima_tot</span><span class="p">,</span> <span class="n">maxima_tot</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; dist&#39;</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">a</span><span class="o">==</span><span class="mi">1</span> <span class="p">:</span>
                <span class="n">matrix_distrib_infomut</span><span class="o">=</span><span class="n">n</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">matrix_distrib_infomut</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">matrix_distrib_infomut</span><span class="p">,</span><span class="n">n</span><span class="p">]</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1">#   COMPUTE THE INFOMUT LANDSCAPE FROM THE HISTOGRAMS AS THE MATRIX  matrix_distrib_infomut</span>
<span class="c1">#   If shuffle is true it also plots the signifiance test against independence null hypothesis</span>
        <span class="n">num_fig</span><span class="o">=</span><span class="n">num_fig</span><span class="o">+</span><span class="mi">1</span>
        <span class="n">fig_infolandscape</span> <span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num_fig</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
        <span class="n">matrix_distrib_infomut</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">matrix_distrib_infomut</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">matrix_distrib_infomut</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="p">,</span><span class="n">minima_tot</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="n">maxima_tot</span><span class="o">+</span><span class="mf">0.1</span><span class="p">],</span> <span class="n">norm</span><span class="o">=</span><span class="n">LogNorm</span><span class="p">(),</span> <span class="n">fignum</span><span class="o">=</span> <span class="n">num_fig</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="p">,</span><span class="n">minima_tot</span><span class="p">,</span><span class="n">maxima_tot</span><span class="p">])</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_shuffle</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">abssice</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="p">)</span>
            <span class="n">low_ordinate</span><span class="o">=</span><span class="p">[]</span>
            <span class="n">high_ordinate</span><span class="o">=</span><span class="p">[]</span>
            <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">low_ordinate</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">low_signif_bound</span><span class="p">[</span><span class="n">a</span><span class="p">])</span>
                <span class="n">high_ordinate</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">high_signif_bound</span><span class="p">[</span><span class="n">a</span><span class="p">])</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">abssice</span><span class="p">,</span> <span class="n">low_ordinate</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">abssice</span><span class="p">,</span> <span class="n">high_ordinate</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Ik landscape&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;dimension&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Ik value (bits)&#39;</span><span class="p">)</span>
        <span class="n">fig_infolandscape</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;# of tuples&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">270</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="c1">#########################################################################</span>
<span class="c1">#########################################################################</span>
<span class="c1">######    CONDITIONAL ENTROPY and MUTUAL INFORMATION    #################</span>
<span class="c1">#########################################################################</span>
<span class="c1">#########################################################################</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function computes all conditional entropy and conditional informations (conditionning by a single variable)</span>
<span class="sd">    They are given by chain rules and correspond to each edges of the lattice.</span>
<span class="sd">    the output is a list of dictionaries dico_input_CONDtot[i-1] items are of the forms ((5, 7, 9), 0.3528757654347521)  for</span>
<span class="sd">    the information of 5,7 knowing 9, e.g. I(5,7|9)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">conditional_info_simplicial_lanscape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dico_input</span><span class="p">):</span>
        <span class="n">num_fig</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">fig_Histo_infomut</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num_fig</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
        <span class="n">matrix_distrib_info</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="c1"># Display every Histo with its own scales:</span>
        <span class="n">ListInfomutcond</span><span class="o">=</span><span class="p">{}</span>
        <span class="n">maxima_tot</span><span class="o">=-</span><span class="mf">1000000.00</span>
        <span class="n">minima_tot</span><span class="o">=</span><span class="mf">1000000.00</span>
        <span class="n">dico_input_COND</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">dico_input_CONDtot</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">ListInfomutcond</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">[]</span>
            <span class="n">dico_input_CONDperORDER</span><span class="o">=</span><span class="p">[]</span>
            <span class="n">dico_input_COND</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dico_input_CONDperORDER</span><span class="p">)</span>
            <span class="n">dicobis</span><span class="o">=</span><span class="p">{}</span>
            <span class="n">dico_input_CONDtot</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dicobis</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">dico</span><span class="o">=</span><span class="p">{}</span>
                <span class="n">dico_input_COND</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dico</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">dico_input</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
                        <span class="k">if</span> <span class="p">(</span><span class="n">b</span><span class="o">==</span><span class="n">i</span><span class="p">):</span>
                            <span class="n">xbis</span><span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">x</span> <span class="k">if</span> <span class="p">(</span><span class="n">a</span><span class="o">!=</span><span class="n">i</span><span class="p">))</span>
                            <span class="n">cond</span><span class="o">=</span> <span class="n">dico_input</span><span class="p">[</span><span class="n">xbis</span><span class="p">]</span><span class="o">-</span><span class="n">y</span>
                            <span class="k">if</span> <span class="n">cond</span><span class="o">&gt;</span><span class="n">maxima_tot</span><span class="p">:</span>
                                <span class="n">maxima_tot</span><span class="o">=</span><span class="n">cond</span>
                            <span class="k">if</span> <span class="n">cond</span><span class="o">&lt;</span><span class="n">minima_tot</span><span class="p">:</span>
                               <span class="n">minima_tot</span><span class="o">=</span><span class="n">cond</span>
     <span class="c1"># for conditioning per degree</span>
                            <span class="n">ListInfomutcond</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cond</span><span class="p">)</span>
     <span class="c1"># for conditioning per variable</span>
                            <span class="n">dico_input_COND</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">xbis</span><span class="p">]</span><span class="o">=</span><span class="n">cond</span>
                            <span class="n">xter</span> <span class="o">=</span> <span class="n">xbis</span> <span class="o">+</span> <span class="p">((</span><span class="n">i</span><span class="p">),)</span>
                            <span class="n">dico_input_CONDtot</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">xter</span><span class="p">]</span><span class="o">=</span><span class="n">cond</span>
     <span class="c1"># The last term in the tuple is the conditionning variable</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">&lt;</span><span class="mi">9</span> <span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">&lt;=</span><span class="mi">16</span> <span class="p">:</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
                <span class="k">else</span> <span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">&lt;=</span><span class="mi">20</span> <span class="p">:</span>
                        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">:</span>
                        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
            <span class="n">ListInfomutcond</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">minima_tot</span><span class="o">-</span><span class="mf">0.1</span><span class="p">)</span>
            <span class="n">ListInfomutcond</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">maxima_tot</span><span class="o">+</span><span class="mf">0.1</span><span class="p">)</span>
            <span class="n">n</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">patches</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ListInfomutcond</span><span class="p">[</span><span class="n">a</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">nb_bins_histo</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;condInfo&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; dist&#39;</span><span class="p">))</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="n">minima_tot</span><span class="p">,</span> <span class="n">maxima_tot</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">a</span><span class="o">==</span><span class="mi">1</span> <span class="p">:</span>
               <span class="n">matrix_distrib_info</span><span class="o">=</span><span class="n">n</span>
            <span class="k">else</span><span class="p">:</span>
               <span class="n">matrix_distrib_info</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">matrix_distrib_info</span><span class="p">,</span><span class="n">n</span><span class="p">]</span>

        <span class="n">num_fig</span><span class="o">=</span><span class="n">num_fig</span><span class="o">+</span><span class="mi">1</span>
        <span class="n">fig_infocondlandscape</span> <span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num_fig</span><span class="p">)</span>
        <span class="n">matrix_distrib_info</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">matrix_distrib_info</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">matrix_distrib_info</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="p">,</span><span class="n">minima_tot</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="n">maxima_tot</span><span class="o">+</span><span class="mf">0.1</span><span class="p">],</span> <span class="n">norm</span><span class="o">=</span><span class="n">LogNorm</span><span class="p">(),</span> <span class="n">fignum</span><span class="o">=</span> <span class="n">num_fig</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="p">,</span><span class="n">minima_tot</span><span class="p">,</span><span class="n">maxima_tot</span><span class="p">])</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;# of tuples&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">270</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;condInfo landscape&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;dimension&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;condInfo value (bits)&#39;</span><span class="p">)</span>
        <span class="n">fig_infocondlandscape</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">dico_input_CONDtot</span>


<span class="c1">#########################################################################</span>
<span class="c1">#########################################################################</span>
<span class="c1">######      Histogramms ENTROPY &amp; MUTUAL INFORMATION   ##################</span>
<span class="c1">###### computes entropy vs information for each degree ##################</span>
<span class="c1">######       ENTROPY  &amp;  INFOMUT LANDSCAPES         #####################</span>
<span class="c1">######                FIGURE 6                  #########################</span>
<span class="c1">#########################################################################</span>
<span class="c1">#########################################################################</span>
<span class="c1">### ENTROPY VS ENERGY VS VOL  Willard Gibbs&#39; 1873 figures two and three</span>
<span class="c1"># (above left and middle) used by Scottish physicist James Clerk Maxwell</span>
<span class="c1"># in 1874 to create a three-dimensional entropy (x), volume (y), energy (z)</span>
<span class="c1"># thermodynamic surface diagram</span>

    <span class="k">def</span> <span class="nf">display_entropy_energy_landscape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Ninfomut</span><span class="p">,</span> <span class="n">Nentropie</span><span class="p">):</span>

        <span class="n">ListInfomutordre</span><span class="o">=</span><span class="p">{}</span>
        <span class="n">ListEntropyordre</span><span class="o">=</span><span class="p">{}</span>
        <span class="n">maxima_tot</span><span class="o">=-</span><span class="mf">1000000.00</span>
        <span class="n">minima_tot</span><span class="o">=</span><span class="mf">1000000.00</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">ListInfomutordre</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">[]</span>
            <span class="n">ListEntropyordre</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">[]</span>

        <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">Ninfomut</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">ListInfomutordre</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
            <span class="n">ListEntropyordre</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Nentropie</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">y</span><span class="o">&gt;</span><span class="n">maxima_tot</span><span class="p">:</span>
                <span class="n">maxima_tot</span><span class="o">=</span><span class="n">y</span>
            <span class="k">if</span> <span class="n">y</span><span class="o">&lt;</span><span class="n">minima_tot</span><span class="p">:</span>
                <span class="n">minima_tot</span><span class="o">=</span><span class="n">y</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">ListInfomutordre</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">minima_tot</span><span class="o">-</span><span class="mf">0.1</span><span class="p">)</span>
            <span class="n">ListInfomutordre</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">maxima_tot</span><span class="o">+</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="n">num_fig</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">num_fig</span> <span class="o">=</span> <span class="n">num_fig</span><span class="o">+</span><span class="mi">1</span>
        <span class="n">fig_entropy_eneregy</span> <span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num_fig</span><span class="p">)</span>

        <span class="n">maxima_tot_entropy</span><span class="o">=-</span><span class="mf">1000000.00</span>
        <span class="n">minima_tot_entropy</span><span class="o">=</span><span class="mf">1000000.00</span>
        <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">Nentropie</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">y</span><span class="o">&gt;</span><span class="n">maxima_tot_entropy</span><span class="p">:</span>
                <span class="n">maxima_tot_entropy</span><span class="o">=</span><span class="n">y</span>
            <span class="k">if</span> <span class="n">y</span><span class="o">&lt;</span><span class="n">minima_tot_entropy</span><span class="p">:</span>
                <span class="n">minima_tot_entropy</span><span class="o">=</span><span class="n">y</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">&lt;=</span><span class="mi">9</span> <span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">&lt;=</span><span class="mi">16</span> <span class="p">:</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
                <span class="k">else</span> <span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">&lt;=</span><span class="mi">20</span> <span class="p">:</span>
                        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">:</span>
                        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
            <span class="n">ListEntropyordre</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">minima_tot_entropy</span><span class="o">-</span><span class="mf">0.1</span><span class="p">)</span>
            <span class="n">ListEntropyordre</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">maxima_tot_entropy</span><span class="o">+</span><span class="mf">0.1</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">hist2d</span><span class="p">(</span><span class="n">ListEntropyordre</span><span class="p">[</span><span class="n">a</span><span class="p">],</span> <span class="n">ListInfomutordre</span><span class="p">[</span><span class="n">a</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nb_bins_histo</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">norm</span><span class="o">=</span><span class="n">LogNorm</span><span class="p">())</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;dim &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">)))</span>
            <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
            <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Counts&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="n">minima_tot_entropy</span><span class="p">,</span> <span class="n">maxima_tot_entropy</span><span class="p">,</span><span class="n">minima_tot</span><span class="p">,</span><span class="n">maxima_tot</span><span class="p">])</span>
        <span class="n">fig_entropy_eneregy</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Entropy vs. Energy landsacpe&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
        <span class="n">fig_entropy_eneregy</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="c1">#########################################################################</span>
<span class="c1">#########################################################################</span>
<span class="c1">######    TOTAL CORRELATION - INTEGRATED INFORMATIOn    #################</span>
<span class="c1">######                    FREE ENERGY                   #################</span>
<span class="c1">#########################################################################</span>
<span class="c1">#########################################################################</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function computes all total correlations or integrated information or free energy</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">total_correlation_simplicial_lanscape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Nentropie</span><span class="p">):</span>
        <span class="n">num_fig</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num_fig</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
        <span class="n">matrix_distrib_info</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="n">maxima_tot</span><span class="o">=-</span><span class="mf">1000000.00</span>
        <span class="n">minima_tot</span><span class="o">=</span><span class="mf">1000000.00</span>
        <span class="n">list_tot_correlation</span><span class="o">=</span><span class="p">{}</span>
        <span class="n">Ntotal_correlation</span><span class="o">=</span><span class="p">{}</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">list_tot_correlation</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">[]</span>

        <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">Nentropie</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">sum_marginals</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
                <span class="n">sum_marginals</span> <span class="o">=</span> <span class="n">sum_marginals</span> <span class="o">+</span> <span class="n">Nentropie</span><span class="p">[(</span><span class="n">var</span><span class="p">,)]</span>
            <span class="n">total_corr</span> <span class="o">=</span>   <span class="n">sum_marginals</span> <span class="o">-</span> <span class="n">y</span>
            <span class="n">Ntotal_correlation</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="p">{</span><span class="n">x</span> <span class="p">:</span> <span class="n">total_corr</span><span class="p">}</span> <span class="p">)</span>
            <span class="n">list_tot_correlation</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">total_corr</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">total_corr</span><span class="o">&gt;</span><span class="n">maxima_tot</span><span class="p">:</span>
                <span class="n">maxima_tot</span><span class="o">=</span><span class="n">total_corr</span>
            <span class="k">if</span> <span class="n">total_corr</span><span class="o">&lt;</span><span class="n">minima_tot</span><span class="p">:</span>
                <span class="n">minima_tot</span><span class="o">=</span><span class="n">total_corr</span>

        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">&lt;=</span><span class="mi">9</span> <span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">&lt;=</span><span class="mi">16</span> <span class="p">:</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
                <span class="k">else</span> <span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">&lt;=</span><span class="mi">20</span> <span class="p">:</span>
                        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">:</span>
                        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
            <span class="n">list_tot_correlation</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">minima_tot</span><span class="o">-</span><span class="mf">0.1</span><span class="p">)</span>
            <span class="n">list_tot_correlation</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">maxima_tot</span><span class="o">+</span><span class="mf">0.1</span><span class="p">)</span>
            <span class="n">n</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">patches</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">list_tot_correlation</span><span class="p">[</span><span class="n">a</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">nb_bins_histo</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="n">minima_tot</span><span class="p">,</span> <span class="n">maxima_tot</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; dist&#39;</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">a</span><span class="o">==</span><span class="mi">1</span> <span class="p">:</span>
                <span class="n">matrix_distrib_info</span><span class="o">=</span><span class="n">n</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">matrix_distrib_info</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">matrix_distrib_info</span><span class="p">,</span><span class="n">n</span><span class="p">]</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">num_fig</span><span class="o">=</span><span class="n">num_fig</span><span class="o">+</span><span class="mi">1</span>
        <span class="n">fig_total_correlation_landscape</span> <span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num_fig</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
        <span class="n">matrix_distrib_info</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">matrix_distrib_info</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">matrix_distrib_info</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="p">,</span><span class="n">minima_tot</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="n">maxima_tot</span><span class="o">+</span><span class="mf">0.1</span><span class="p">],</span> <span class="n">norm</span><span class="o">=</span><span class="n">LogNorm</span><span class="p">(),</span> <span class="n">fignum</span><span class="o">=</span> <span class="n">num_fig</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="p">,</span><span class="n">minima_tot</span><span class="p">,</span><span class="n">maxima_tot</span><span class="p">])</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;# of tuples&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">270</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;dimension&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Gk value (bits)&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Total correlation Gk landscape&#39;</span><span class="p">)</span>
        <span class="n">fig_total_correlation_landscape</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">Ntotal_correlation</span>

<span class="c1">#########################################################################</span>
<span class="c1">#########################################################################</span>
<span class="c1">######          INFORMATION DISTANCE AND VOLUMES        #################</span>
<span class="c1">#########################################################################</span>
<span class="c1">#########################################################################</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function computes all Information distance V(X,Y)=H(X,Y)-I(X,Y), a 2-volume and its generalization to k-volume: Vk=Hk-Ik for all the simplicial structure.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">information_volume_simplicial_lanscape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Nentropie</span><span class="p">,</span> <span class="n">Ninfomut</span><span class="p">):</span>
        <span class="n">num_fig</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num_fig</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
        <span class="n">matrix_distrib_info</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="n">maxima_tot</span><span class="o">=-</span><span class="mf">1000000.00</span>
        <span class="n">minima_tot</span><span class="o">=</span><span class="mf">1000000.00</span>
        <span class="n">list_info_volume</span><span class="o">=</span><span class="p">{}</span>
        <span class="n">Ninfo_volume</span><span class="o">=</span><span class="p">{}</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">list_info_volume</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">[]</span>

        <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">Nentropie</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">sum_marginals</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">info_vol</span> <span class="o">=</span>  <span class="n">y</span> <span class="o">-</span> <span class="n">Ninfomut</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
            <span class="n">Ninfo_volume</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="p">{</span><span class="n">x</span> <span class="p">:</span> <span class="n">info_vol</span><span class="p">}</span> <span class="p">)</span>
            <span class="n">list_info_volume</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">info_vol</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">info_vol</span><span class="o">&gt;</span><span class="n">maxima_tot</span><span class="p">:</span>
                <span class="n">maxima_tot</span><span class="o">=</span><span class="n">info_vol</span>
            <span class="k">if</span> <span class="n">info_vol</span><span class="o">&lt;</span><span class="n">minima_tot</span><span class="p">:</span>
                <span class="n">minima_tot</span><span class="o">=</span><span class="n">info_vol</span>

        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">&lt;=</span><span class="mi">9</span> <span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">&lt;=</span><span class="mi">16</span> <span class="p">:</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
                <span class="k">else</span> <span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">&lt;=</span><span class="mi">20</span> <span class="p">:</span>
                        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">:</span>
                        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
            <span class="n">list_info_volume</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">minima_tot</span><span class="o">-</span><span class="mf">0.1</span><span class="p">)</span>
            <span class="n">list_info_volume</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">maxima_tot</span><span class="o">+</span><span class="mf">0.1</span><span class="p">)</span>
            <span class="n">n</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">patches</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">list_info_volume</span><span class="p">[</span><span class="n">a</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">nb_bins_histo</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="n">minima_tot</span><span class="p">,</span> <span class="n">maxima_tot</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; dist&#39;</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">a</span><span class="o">==</span><span class="mi">1</span> <span class="p">:</span>
                <span class="n">matrix_distrib_info</span><span class="o">=</span><span class="n">n</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">matrix_distrib_info</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">matrix_distrib_info</span><span class="p">,</span><span class="n">n</span><span class="p">]</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">num_fig</span><span class="o">=</span><span class="n">num_fig</span><span class="o">+</span><span class="mi">1</span>
        <span class="n">fig_total_correlation_landscape</span> <span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num_fig</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
        <span class="n">matrix_distrib_info</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">matrix_distrib_info</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">matrix_distrib_info</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="p">,</span><span class="n">minima_tot</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="n">maxima_tot</span><span class="o">+</span><span class="mf">0.1</span><span class="p">],</span> <span class="n">norm</span><span class="o">=</span><span class="n">LogNorm</span><span class="p">(),</span> <span class="n">fignum</span><span class="o">=</span> <span class="n">num_fig</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="p">,</span><span class="n">minima_tot</span><span class="p">,</span><span class="n">maxima_tot</span><span class="p">])</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;# of tuples&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">270</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;dimension&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Vk value (bits)&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Information distance and Volume Vk landscape&#39;</span><span class="p">)</span>
        <span class="n">fig_total_correlation_landscape</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">Ninfo_volume</span>

<span class="c1"># ##########################################################################################</span>
<span class="c1"># ###############              RANKING and DISPLAY of the             ######################</span>
<span class="c1"># ###############   n first higher and lower conditional information  ######################</span>
<span class="c1"># ##########################################################################################</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function prints all the conditional information at a given dimension-order (dimension 1 for H(Xi|Xj) dimension 2 for H(Xi,Xk|Xj)...)</span>
<span class="sd">    the dico_input_CONDtot[i-1] items are of the forms ((5, 7, 9), 0.352875765,347521) for the information of 5,7 knowing 9, e.g. I(5,7|9)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">display_higher_lower_cond_information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dico_input_CONDtot</span><span class="p">):</span>

        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The conditional information at dim&#39;</span><span class="p">,(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_to_rank</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">OrderedDict</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">dico_input_CONDtot</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_to_rank</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span>

<span class="c1">###############################################################</span>
<span class="c1">########          Ring representation               ##########</span>
<span class="c1">###                Mutual information               #########</span>
<span class="c1">###### http://networkx.readthedocs.org/en/stable/   #########</span>
<span class="c1">###############################################################</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ring network - Graph representation of 2nd order - pairwise mutual information and firts order marginal entropy</span>
<span class="sd">    only use the (symmetric nul diagonal - or upper triangular) adjacency matrix of 2-MI</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">mutual_info_pairwise_network</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Ninfomut</span><span class="p">)</span> <span class="p">:</span>
        <span class="n">infomut_per_order</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">info_dicoperoder</span><span class="o">=</span><span class="p">{}</span>
            <span class="n">infomut_per_order</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">info_dicoperoder</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">Ninfomut</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">infomut_per_order</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)][</span><span class="n">x</span><span class="p">]</span><span class="o">=</span><span class="n">Ninfomut</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
        <span class="n">num_fig</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num_fig</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
        <span class="n">netring</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
        <span class="n">list_of_node</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">list_of_size</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">list_of_edge</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">list_of_width</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">list_of_labels</span><span class="o">=</span><span class="p">{}</span>

        <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">infomut_per_order</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">tuple_interim</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="n">list_of_node</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">list_of_labels</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">=</span><span class="n">tuple_interim</span>
            <span class="n">number_node</span><span class="o">=</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
            <span class="n">code_var</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">number_node</span><span class="p">)</span>
            <span class="n">list_of_size</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">infomut_per_order</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">x</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span><span class="mi">500</span><span class="p">)</span>
            <span class="n">netring</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">tuple_interim</span><span class="o">=</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">infomut_per_order</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">list_of_edge</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="n">var_1</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">var_2</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">netring</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">var_1</span><span class="p">,</span> <span class="n">var_2</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span> <span class="p">(</span><span class="n">infomut_per_order</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">x</span><span class="p">])</span> <span class="p">)</span>
            <span class="n">list_of_width</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">infomut_per_order</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">x</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">nx</span><span class="o">.</span><span class="n">draw_circular</span><span class="p">(</span><span class="n">netring</span><span class="p">,</span> <span class="n">with_labels</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">nodelist</span> <span class="o">=</span> <span class="n">list_of_node</span><span class="p">,</span><span class="n">edgelist</span> <span class="o">=</span> <span class="n">list_of_edge</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span> <span class="n">list_of_width</span><span class="p">,</span> <span class="n">node_size</span> <span class="o">=</span> <span class="n">list_of_size</span><span class="p">)</span>
        <span class="n">adjacency_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">list_of_node</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_of_node</span><span class="p">)))</span>
        <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">infomut_per_order</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">adjacency_matrix</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span>
            <span class="n">adjacency_matrix</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span>
        <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">infomut_per_order</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">adjacency_matrix</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">infomut_per_order</span><span class="p">[</span><span class="mi">1</span><span class="p">][(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],)]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Information adjacency matrix (I1 and I2)&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">adjacency_matrix</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;hot&#39;</span><span class="p">)</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Information (bits)&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">270</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">adjacency_matrix</span>



<span class="c1"># ########################################################################################</span>
<span class="c1"># ###############              RANKING and DISPLAY of the           ######################</span>
<span class="c1"># ###############   n first higher and lower Mutual information     ######################</span>
<span class="c1"># ########################################################################################</span>

    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    This function ranks the tuples in dimension k=dim_to_rank as a funtion  entropy or information</span>
<span class="sd">    and print and plot de data points k subsapce of  the n first maximum and minimum values (n=number_of_max_val)</span>
<span class="sd">    if the dimension is 2,3 or 4 (when ploting is possible). For 4D plot the 4th dimension is given by the colorscale</span>
<span class="sd">    of the points</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">display_higher_lower_information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dico_input</span><span class="p">,</span> <span class="n">dataset</span><span class="p">):</span>
        <span class="n">dico_at_order</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">dico_input</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim_to_rank</span> <span class="p">:</span>
                <span class="n">dico_at_order</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">=</span><span class="n">dico_input</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
        <span class="n">topitems</span> <span class="o">=</span> <span class="n">heapq</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_max_val</span><span class="p">,</span> <span class="n">dico_at_order</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">topitemsasdict_max</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">topitems</span><span class="p">)</span>

        <span class="c1"># here we plot the number_of_max_val first maxima</span>
        <span class="n">fig1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
        <span class="n">ax1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_max_val</span><span class="p">))</span>
        <span class="n">nb_plot</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">aaaa</span><span class="o">=</span><span class="mi">0</span>

        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">topitemsasdict_max</span> <span class="p">:</span>
            <span class="n">aaaa</span><span class="o">=</span><span class="n">aaaa</span><span class="o">+</span><span class="mi">1</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">aaaa</span><span class="p">,</span> <span class="s2">&quot;max value in dimension&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim_to_rank</span> <span class="p">,</span><span class="s2">&quot; is for the tuple&quot;</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span>  <span class="s2">&quot;   with Fk value  :&quot;</span><span class="p">,</span> <span class="n">topitemsasdict_max</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim_to_rank</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig1</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_max_val</span><span class="p">,</span> <span class="n">nb_plot</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">dataset</span><span class="p">[:,</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dataset</span><span class="p">[:,</span><span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>  <span class="n">c</span><span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;8&#39;</span><span class="p">)</span>
                <span class="n">string_title</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">aaaa</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;max : F&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_to_rank</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;(&quot;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;)=&quot;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">topitemsasdict_max</span><span class="p">[</span><span class="n">key</span><span class="p">],</span><span class="mi">2</span><span class="p">)))</span>
                <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">string_title</span><span class="p">)</span>
                <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;variable&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
                <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;variable&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">nb_plot</span> <span class="o">=</span><span class="n">nb_plot</span> <span class="o">+</span><span class="mi">1</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim_to_rank</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig1</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_max_val</span><span class="p">,</span> <span class="n">nb_plot</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
                <span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">dataset</span><span class="p">[:,</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dataset</span><span class="p">[:,</span><span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dataset</span><span class="p">[:,</span><span class="n">key</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>  <span class="n">c</span><span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;8&#39;</span><span class="p">)</span>
                <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;variable&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
                <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;variable&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                <span class="n">ax1</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;variable&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
                <span class="n">string_title</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">aaaa</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;max : F&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_to_rank</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;(&quot;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;)=&quot;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">topitemsasdict_max</span><span class="p">[</span><span class="n">key</span><span class="p">],</span><span class="mi">2</span><span class="p">)))</span>
                <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">string_title</span><span class="p">)</span>
                <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">nb_plot</span> <span class="o">=</span><span class="n">nb_plot</span> <span class="o">+</span><span class="mi">1</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim_to_rank</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig1</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_max_val</span><span class="p">,</span> <span class="n">nb_plot</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
                <span class="n">pts</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">dataset</span><span class="p">[:,</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dataset</span><span class="p">[:,</span><span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dataset</span><span class="p">[:,</span><span class="n">key</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">dataset</span><span class="p">[:,</span><span class="n">key</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;8&#39;</span><span class="p">)</span>
                <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;variable&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
                <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;variable&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                <span class="n">ax1</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;variable&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
                <span class="n">cbar</span> <span class="o">=</span> <span class="n">fig1</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
                <span class="n">string_title</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">aaaa</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;max : F&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_to_rank</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;(&quot;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;)=&quot;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">topitemsasdict_max</span><span class="p">[</span><span class="n">key</span><span class="p">],</span><span class="mi">2</span><span class="p">)))</span>
                <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">string_title</span><span class="p">)</span>
                <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">nb_plot</span> <span class="o">=</span><span class="n">nb_plot</span> <span class="o">+</span><span class="mi">1</span>

        <span class="n">topitems</span> <span class="o">=</span> <span class="n">heapq</span><span class="o">.</span><span class="n">nsmallest</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_max_val</span><span class="p">,</span> <span class="n">dico_at_order</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">topitemsasdict_min</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">topitems</span><span class="p">)</span>

        <span class="c1"># here we plot the number_of_max_val first minima</span>

        <span class="n">fig2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
        <span class="n">ax2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_max_val</span><span class="p">))</span>
        <span class="n">aaaa</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">nb_plot</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">topitemsasdict_min</span> <span class="p">:</span>
            <span class="n">aaaa</span><span class="o">=</span><span class="n">aaaa</span><span class="o">+</span><span class="mi">1</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">aaaa</span><span class="p">,</span> <span class="s2">&quot;min value in dimension&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim_to_rank</span> <span class="p">,</span><span class="s2">&quot; is for the tuple&quot;</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span>  <span class="s2">&quot;   with Fk value  :&quot;</span><span class="p">,</span> <span class="n">topitemsasdict_min</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim_to_rank</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">ax2</span> <span class="o">=</span> <span class="n">fig2</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_max_val</span><span class="p">,</span> <span class="n">nb_plot</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">dataset</span><span class="p">[:,</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dataset</span><span class="p">[:,</span><span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>  <span class="n">c</span><span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;8&#39;</span><span class="p">)</span>
                <span class="n">string_title</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">aaaa</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;min : F&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_to_rank</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;(&quot;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;)=&quot;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">topitemsasdict_min</span><span class="p">[</span><span class="n">key</span><span class="p">],</span><span class="mi">2</span><span class="p">)))</span>
                <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">string_title</span><span class="p">)</span>
                <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;variable&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
                <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;variable&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">nb_plot</span> <span class="o">=</span><span class="n">nb_plot</span> <span class="o">+</span><span class="mi">1</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim_to_rank</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">ax2</span> <span class="o">=</span> <span class="n">fig2</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_max_val</span><span class="p">,</span> <span class="n">nb_plot</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
                <span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">dataset</span><span class="p">[:,</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dataset</span><span class="p">[:,</span><span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dataset</span><span class="p">[:,</span><span class="n">key</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>  <span class="n">c</span><span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;8&#39;</span><span class="p">)</span>
                <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;variable&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
                <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;variable&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                <span class="n">ax2</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;variable&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
                <span class="n">string_title</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">aaaa</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;min : F&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_to_rank</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;(&quot;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;)=&quot;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">topitemsasdict_min</span><span class="p">[</span><span class="n">key</span><span class="p">],</span><span class="mi">2</span><span class="p">)))</span>
                <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">string_title</span><span class="p">)</span>
                <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">nb_plot</span> <span class="o">=</span><span class="n">nb_plot</span> <span class="o">+</span><span class="mi">1</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim_to_rank</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                <span class="n">ax2</span> <span class="o">=</span> <span class="n">fig2</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_max_val</span><span class="p">,</span> <span class="n">nb_plot</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
                <span class="n">pts</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">dataset</span><span class="p">[:,</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dataset</span><span class="p">[:,</span><span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dataset</span><span class="p">[:,</span><span class="n">key</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">dataset</span><span class="p">[:,</span><span class="n">key</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;8&#39;</span><span class="p">)</span>
                <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;variable&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
                <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;variable&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                <span class="n">ax2</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;variable&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
                <span class="n">cbar</span> <span class="o">=</span> <span class="n">fig2</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
                <span class="n">string_title</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">aaaa</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;min : F&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim_to_rank</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;(&quot;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;)=&quot;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">topitemsasdict_min</span><span class="p">[</span><span class="n">key</span><span class="p">],</span><span class="mi">2</span><span class="p">)))</span>
                <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">string_title</span><span class="p">)</span>
                <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">nb_plot</span> <span class="o">=</span><span class="n">nb_plot</span> <span class="o">+</span><span class="mi">1</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">topitemsasdict_max</span><span class="p">,</span> <span class="n">topitemsasdict_min</span><span class="p">)</span>


<span class="c1"># ############################################################################################</span>
<span class="c1"># ###############              PLOT MEAN INFORMATION RATE               ######################</span>
<span class="c1"># ###############    PLOT MEAN ENTROPY RATE NORMALISED BY BINOMIAL      ######################</span>
<span class="c1"># ############################################################################################</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    This function plotts at each dimension k the mean information (entropy, Mutual-Information...) rate and the mean information</span>
<span class="sd">    (entropy, Mutual-Information...) rate normalised by the binomial coeficient C(k,n)</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">display_mean_information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dico_input</span><span class="p">):</span>
<span class="c1">#########################################################################</span>
<span class="c1">###########                MEAN INFO                          ###########</span>
<span class="c1">###########  SUM INFO  normalised by Binomial coefficients    ###########</span>
<span class="c1">###########  (MEAN-FIELD APPROXIMATION HOMOGENEOUS SYSTEM)    ###########</span>
<span class="c1">#########################################################################</span>
        <span class="n">info_sum_order</span><span class="o">=</span><span class="p">{}</span>
        <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">dico_input</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">info_sum_order</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span><span class="o">=</span><span class="n">info_sum_order</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="n">dico_input</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
        <span class="n">num_fig</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">num_fig</span> <span class="o">=</span> <span class="n">num_fig</span><span class="o">+</span><span class="mi">1</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num_fig</span><span class="p">)</span>
        <span class="n">maxordonnee</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1000000.00</span>
        <span class="n">minordonnee</span> <span class="o">=</span> <span class="mf">1000000.00</span>
        <span class="n">mean</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">xxx</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">info_sum_order</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">mean</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">_binomial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_tot</span><span class="p">,</span><span class="n">x</span><span class="p">))</span>
            <span class="n">xxx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xxx</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;(Bits/symbols)&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Mean info function&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1">#########################################################################</span>
<span class="c1">###########                MEAN INFO  RATE                    ###########</span>
<span class="c1">###########  SUM INFO  normalised by Binomial coefficients    ###########</span>
<span class="c1">###########  (MEAN-FIELD APPROXIMATION HOMOGENEOUS SYSTEM)    ###########</span>
<span class="c1">#########################################################################</span>

        <span class="n">num_fig</span> <span class="o">=</span> <span class="n">num_fig</span><span class="o">+</span><span class="mi">1</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num_fig</span><span class="p">)</span>
        <span class="n">maxordonnee</span><span class="o">=-</span><span class="mf">1000000.00</span>
        <span class="n">minordonnee</span><span class="o">=</span><span class="mf">1000000.00</span>
        <span class="n">rate</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">xxx</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">info_sum_order</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">rate</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_binomial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_tot</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="p">))</span>
            <span class="n">xxx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xxx</span><span class="p">,</span> <span class="n">rate</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;(Bits/symbols)&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Mean info rate function&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">rate</span><span class="p">)</span>


<span class="c1">###############################################################</span>
<span class="c1">###############################################################</span>
<span class="c1">########              INFORMATION FIT                ##########</span>
<span class="c1">########                                             ##########</span>
<span class="c1">###############################################################</span>
<span class="c1">###############################################################</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    This function is just a basic wrapper on previous functions to provide a scikit or tensorflow (...) like fit function</span>
<span class="sd">    ... to help users.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">):</span>
        <span class="n">Nentropie</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">simplicial_entropies_decomposition</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
        <span class="n">Ninfomut</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">simplicial_infomut_decomposition</span><span class="p">(</span><span class="n">Nentropie</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Ninfomut</span><span class="p">,</span> <span class="n">Nentropie</span>

<span class="c1">###############################################################</span>
<span class="c1">###############################################################</span>
<span class="c1">########              INFORMATION PATHS              ##########</span>
<span class="c1">########  INFORMATION COMPLEX - FREE-ENERGY COMPLEX  ##########</span>
<span class="c1">###############################################################</span>
<span class="c1">###############################################################</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    This function compute and plotts approximation of the information (free-energy) complex by computing information paths: An information path IPk  of degree k</span>
<span class="sd">    on Ik landscape is defined as a sequence of elements of the lattice that begins at the least element of the lattice (the identity-constant “0”),</span>
<span class="sd">    travels along edges from element to element of increasing degree of the lattice and ends at the greatest element of the lattice of degree k. The</span>
<span class="sd">    first derivative of an IPk path is minus the conditional mutual information. The critical dimension of an IP k path is the degree of its first minimum.</span>
<span class="sd">    A positive information path is an information path from 0 to a given I k corresponding to a given k-tuple of variables such that Ik&lt;Ik-1&lt;...&lt;I1 .</span>
<span class="sd">    We call the interacting components functions Ik , k&gt;1, a free information energy. A maximal positive information path is a positive information path</span>
<span class="sd">    of maximal length: it ends at minima of the free information energy function. The set of all these paths defines uniquely the minimum free energy complex.</span>
<span class="sd">    The set of all paths of degree k is intractable computationally (complexity in O(k!)). In order to bypass this issue, the algo computes a fast local</span>
<span class="sd">    algorithm that selects at each element of degree k of an IP path the positive information path with maximal or minimal Ik+1 value or stops whenever Xk.I k+1≤ 0</span>
<span class="sd">    and ranks those paths by their length.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">information_complex</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">Ninfomut</span><span class="p">):</span>

        <span class="n">infomut_per_order</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">Ninfomut_per_order_ordered</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">info_dicoperoder</span><span class="o">=</span><span class="p">{}</span>
            <span class="n">infomut_per_order</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">info_dicoperoder</span><span class="p">)</span>
            <span class="n">Ninfomut_per_order_ordered</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">info_dicoperoder</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">Ninfomut</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">infomut_per_order</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)][</span><span class="n">x</span><span class="p">]</span><span class="o">=</span><span class="n">Ninfomut</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">Ninfomut_per_order_ordered</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">infomut_per_order</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

        <span class="n">matrix_distrib_infomut</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="n">x_absss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="n">y_absss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="n">maxima_tot</span><span class="o">=-</span><span class="mf">1000000.00</span>
        <span class="n">minima_tot</span><span class="o">=</span><span class="mf">1000000.00</span>
        <span class="n">infocond</span><span class="o">=</span><span class="mf">1000000.00</span>
        <span class="n">listartbis</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">infomutmax_path_VAR</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">infomutmax_path_VALUE</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">infomutmin_path_VAR</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">infomutmin_path_VALUE</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">number_of_max_and_min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span> <span class="c1">#explore the 2 max an min marginals (of degree 1 information)</span>
        <span class="n">items</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">Ninfomut_per_order_ordered</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">inforank</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">number_of_max_and_min</span><span class="p">):</span>
            <span class="n">infomutmax_path_VAR</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
            <span class="n">infomutmax_path_VALUE</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
            <span class="n">infomutmin_path_VAR</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
            <span class="n">infomutmin_path_VALUE</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
            <span class="n">xstart</span><span class="o">=</span><span class="n">items</span><span class="p">[</span><span class="n">inforank</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">xstartmin</span> <span class="o">=</span> <span class="n">items</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span> <span class="o">-</span> <span class="n">inforank</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>   <span class="c1">#items[self.dimension_max-inforank-1][0]</span>
            <span class="n">infomutmax_path_VAR</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xstart</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">infomutmax_path_VALUE</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="n">inforank</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">infomutmin_path_VAR</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xstartmin</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">infomutmin_path_VALUE</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span> <span class="o">-</span> <span class="n">inforank</span><span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">degree</span><span class="o">=</span><span class="mi">1</span>
            <span class="n">infocond</span><span class="o">=</span><span class="mf">1000000.00</span>
            <span class="k">while</span> <span class="n">infocond</span> <span class="o">&gt;=</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">degree</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="p">:</span>
                <span class="n">maxima_tot</span><span class="o">=-</span><span class="mf">1000000.00</span>
                <span class="n">minima_tot</span><span class="o">=</span><span class="mf">1000000.00</span>
                <span class="n">degree</span><span class="o">=</span><span class="n">degree</span><span class="o">+</span><span class="mi">1</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">:</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">infomutmax_path_VAR</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">:</span>
                        <span class="k">del</span> <span class="n">listartbis</span><span class="p">[:]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">del</span> <span class="n">listartbis</span><span class="p">[:]</span>
                        <span class="n">listartbis</span><span class="o">=</span><span class="n">infomutmax_path_VAR</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:]</span>
                        <span class="n">listartbis</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                        <span class="n">listartbis</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
                        <span class="n">tuplestart</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">listartbis</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">infomut_per_order</span><span class="p">[</span><span class="n">degree</span><span class="p">][</span><span class="n">tuplestart</span><span class="p">]</span><span class="o">&gt;</span><span class="n">maxima_tot</span><span class="p">:</span>
                            <span class="n">maxima_tot</span><span class="o">=</span><span class="n">infomut_per_order</span><span class="p">[</span><span class="n">degree</span><span class="p">][</span><span class="n">tuplestart</span><span class="p">]</span>
                            <span class="n">igood</span><span class="o">=</span> <span class="n">i</span>
                <span class="n">infomutmax_path_VAR</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">igood</span><span class="p">)</span>
                <span class="n">infomutmax_path_VALUE</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">maxima_tot</span><span class="p">)</span>
                <span class="n">infocond</span><span class="o">=</span> <span class="n">infomutmax_path_VALUE</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span> <span class="n">infomutmax_path_VALUE</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">del</span> <span class="n">infomutmax_path_VAR</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">del</span> <span class="n">infomutmax_path_VALUE</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The path of maximal mutual-info Nb&#39;</span><span class="p">,</span><span class="n">inforank</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39; is :&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">infomutmax_path_VAR</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

            <span class="n">degree</span><span class="o">=</span><span class="mi">1</span>
            <span class="n">infocond</span><span class="o">=</span><span class="mf">1000000.00</span>
            <span class="k">while</span> <span class="n">infocond</span> <span class="o">&gt;=</span><span class="mi">0</span> <span class="p">:</span>
                <span class="n">maxima_tot</span><span class="o">=-</span><span class="mf">1000000.00</span>
                <span class="n">minima_tot</span><span class="o">=</span><span class="mf">1000000.00</span>
                <span class="n">degree</span><span class="o">=</span><span class="n">degree</span><span class="o">+</span><span class="mi">1</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">:</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">infomutmin_path_VAR</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">:</span>
                        <span class="k">del</span> <span class="n">listartbis</span><span class="p">[:]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">del</span> <span class="n">listartbis</span><span class="p">[:]</span>
                        <span class="n">listartbis</span><span class="o">=</span><span class="n">infomutmin_path_VAR</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:]</span>
                        <span class="n">listartbis</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                        <span class="n">listartbis</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
                        <span class="n">tuplestart</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">listartbis</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">infomut_per_order</span><span class="p">[</span><span class="n">degree</span><span class="p">][</span><span class="n">tuplestart</span><span class="p">]</span><span class="o">&lt;</span><span class="n">minima_tot</span><span class="p">:</span>
                            <span class="n">minima_tot</span><span class="o">=</span><span class="n">infomut_per_order</span><span class="p">[</span><span class="n">degree</span><span class="p">][</span><span class="n">tuplestart</span><span class="p">]</span>
                            <span class="n">igood</span><span class="o">=</span> <span class="n">i</span>
                <span class="n">infomutmin_path_VAR</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">igood</span><span class="p">)</span>
                <span class="n">infomutmin_path_VALUE</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">minima_tot</span><span class="p">)</span>
                <span class="n">infocond</span><span class="o">=</span> <span class="n">infomutmin_path_VALUE</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span> <span class="n">infomutmin_path_VALUE</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">del</span> <span class="n">infomutmin_path_VAR</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">del</span> <span class="n">infomutmin_path_VALUE</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The path of minimal mutual-info Nb&#39;</span><span class="p">,</span><span class="n">inforank</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39; is :&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">infomutmin_path_VAR</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># COMPUTE THE HISTOGRAMS OF INFORMATION</span>

        <span class="n">ListInfomutordre</span><span class="o">=</span><span class="p">{}</span>
        <span class="n">maxima_tot</span><span class="o">=-</span><span class="mf">1000000.00</span>
        <span class="n">minima_tot</span><span class="o">=</span><span class="mf">1000000.00</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">ListInfomutordre</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">Ninfomut</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">ListInfomutordre</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">y</span><span class="o">&gt;</span><span class="n">maxima_tot</span><span class="p">:</span>
                <span class="n">maxima_tot</span><span class="o">=</span><span class="n">y</span>
            <span class="k">if</span> <span class="n">y</span><span class="o">&lt;</span><span class="n">minima_tot</span><span class="p">:</span>
                <span class="n">minima_tot</span><span class="o">=</span><span class="n">y</span>

        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">ListInfomutordre</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">minima_tot</span><span class="o">-</span><span class="mf">0.1</span><span class="p">)</span>
            <span class="n">ListInfomutordre</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">maxima_tot</span><span class="o">+</span><span class="mf">0.1</span><span class="p">)</span>
            <span class="n">n</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">ListInfomutordre</span><span class="p">[</span><span class="n">a</span><span class="p">],</span>  <span class="n">bins</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nb_bins_histo</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">a</span><span class="o">==</span><span class="mi">1</span> <span class="p">:</span>
                <span class="n">matrix_distrib_infomut</span><span class="o">=</span><span class="n">n</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">matrix_distrib_infomut</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">matrix_distrib_infomut</span><span class="p">,</span><span class="n">n</span><span class="p">]</span>

<span class="c1"># COMPUTE THE MATRIX OF INFORMATION LANDSACPES</span>

        <span class="n">num_fig</span><span class="o">=</span><span class="mi">1</span>
        <span class="n">fig_infopath</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num_fig</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
        <span class="n">matrix_distrib_infomut</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">matrix_distrib_infomut</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">matrix_distrib_infomut</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="p">,</span><span class="n">minima_tot</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="n">maxima_tot</span><span class="o">+</span><span class="mf">0.1</span><span class="p">],</span> <span class="n">norm</span><span class="o">=</span><span class="n">LogNorm</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">200000</span><span class="p">),</span> <span class="n">fignum</span><span class="o">=</span> <span class="n">num_fig</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_max</span><span class="p">,</span><span class="n">minima_tot</span><span class="p">,</span><span class="n">maxima_tot</span><span class="p">])</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;# of tuples&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">270</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>


<span class="c1"># COMPUTE THE INFORMATION PATHS</span>
        <span class="n">x_infomax</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">x_infomin</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">maxima_x</span><span class="o">=-</span><span class="mi">10</span>
        <span class="n">maxima_tot</span><span class="o">=-</span><span class="mf">1000000.00</span>
        <span class="n">minima_tot</span><span class="o">=</span><span class="mf">1000000.00</span>
        <span class="k">for</span> <span class="n">inforank</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">number_of_max_and_min</span><span class="p">):</span>
            <span class="n">x_infomax</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
            <span class="n">j</span><span class="o">=-</span><span class="mf">0.5</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span>  <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">infomutmax_path_VALUE</span><span class="p">[</span><span class="n">inforank</span><span class="p">])):</span>
                <span class="n">j</span><span class="o">=</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span>
                <span class="n">x_infomax</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="n">maxima_x</span><span class="p">:</span>
                    <span class="n">maxima_x</span><span class="o">=</span><span class="n">j</span>
                <span class="k">if</span> <span class="n">infomutmax_path_VALUE</span><span class="p">[</span><span class="n">inforank</span><span class="p">][</span><span class="nb">int</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)]</span><span class="o">&gt;</span><span class="n">maxima_tot</span> <span class="p">:</span>
                    <span class="n">maxima_tot</span><span class="o">=</span><span class="n">infomutmax_path_VALUE</span><span class="p">[</span><span class="n">inforank</span><span class="p">][</span><span class="nb">int</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)]</span>
                <span class="k">if</span> <span class="n">infomutmax_path_VALUE</span><span class="p">[</span><span class="n">inforank</span><span class="p">][</span><span class="nb">int</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)]</span><span class="o">&lt;</span><span class="n">minima_tot</span> <span class="p">:</span>
                    <span class="n">minima_tot</span><span class="o">=</span><span class="n">infomutmax_path_VALUE</span><span class="p">[</span><span class="n">inforank</span><span class="p">][</span><span class="nb">int</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)]</span>

            <span class="n">x_infomin</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
            <span class="n">j</span><span class="o">=-</span><span class="mf">0.5</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span>  <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">infomutmin_path_VALUE</span><span class="p">[</span><span class="n">inforank</span><span class="p">])):</span>
                <span class="n">j</span><span class="o">=</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span>
                <span class="n">x_infomin</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="n">maxima_x</span><span class="p">:</span>
                    <span class="n">maxima_x</span><span class="o">=</span><span class="n">j</span>
                <span class="k">if</span> <span class="n">infomutmin_path_VALUE</span><span class="p">[</span><span class="n">inforank</span><span class="p">][</span><span class="nb">int</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)]</span><span class="o">&gt;</span><span class="n">maxima_tot</span> <span class="p">:</span>
                    <span class="n">maxima_tot</span><span class="o">=</span><span class="n">infomutmin_path_VALUE</span><span class="p">[</span><span class="n">inforank</span><span class="p">][</span><span class="nb">int</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)]</span>
                <span class="k">if</span> <span class="n">infomutmin_path_VALUE</span><span class="p">[</span><span class="n">inforank</span><span class="p">][</span><span class="nb">int</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)]</span><span class="o">&lt;</span><span class="n">minima_tot</span> <span class="p">:</span>
                    <span class="n">minima_tot</span><span class="o">=</span><span class="n">infomutmin_path_VALUE</span><span class="p">[</span><span class="n">inforank</span><span class="p">][</span><span class="nb">int</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)]</span>

            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_infomax</span><span class="p">[</span><span class="n">inforank</span><span class="p">],</span> <span class="n">infomutmax_path_VALUE</span><span class="p">[</span><span class="n">inforank</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_infomin</span><span class="p">[</span><span class="n">inforank</span><span class="p">],</span> <span class="n">infomutmin_path_VALUE</span><span class="p">[</span><span class="n">inforank</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">maxima_x</span><span class="o">+</span><span class="mf">0.5</span><span class="p">,</span><span class="n">minima_tot</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span><span class="n">maxima_tot</span><span class="o">+</span><span class="mf">0.2</span><span class="p">])</span>


        <span class="n">display_labelnodes</span><span class="o">=</span><span class="kc">False</span>
        <span class="k">if</span> <span class="n">display_labelnodes</span> <span class="p">:</span>
            <span class="k">for</span> <span class="n">inforank</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">number_of_max_and_min</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">infomutmax_path_VAR</span><span class="p">[</span><span class="n">inforank</span><span class="p">],</span> <span class="n">x_infomax</span><span class="p">[</span><span class="n">inforank</span><span class="p">],</span> <span class="n">infomutmax_path_VALUE</span><span class="p">[</span><span class="n">inforank</span><span class="p">]):</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">label</span><span class="p">,</span><span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span><span class="n">textcoords</span><span class="o">=</span><span class="s1">&#39;offset points&#39;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">infomutmin_path_VAR</span><span class="p">[</span><span class="n">inforank</span><span class="p">],</span> <span class="n">x_infomin</span><span class="p">[</span><span class="n">inforank</span><span class="p">],</span> <span class="n">infomutmin_path_VALUE</span><span class="p">[</span><span class="n">inforank</span><span class="p">]):</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">label</span><span class="p">,</span><span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span><span class="n">textcoords</span><span class="o">=</span><span class="s1">&#39;offset points&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Ik paths - information - Free Energy complex&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;dimension&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Ik value (bits)&#39;</span><span class="p">)</span>
        <span class="n">fig_infopath</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<span class="c1">###################################################################################</span>
<span class="c1">################             COMPUTE INFOPATH               #######################</span>
<span class="c1">###################################################################################</span>

<span class="k">def</span> <span class="nf">compute_info_path</span><span class="p">(</span><span class="n">data_mat</span><span class="p">,</span> <span class="n">dimension_max</span><span class="p">,</span> <span class="n">dimension_tot</span><span class="p">,</span> <span class="n">nbtrials</span><span class="p">):</span>
    <span class="n">Nentropie</span><span class="o">=</span><span class="p">{}</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(asctime)s</span><span class="s1"> : </span><span class="si">%(levelname)s</span><span class="s1"> : </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
    <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;compute info_path&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Percent of tuples processed : 0&quot;</span><span class="p">)</span>
    <span class="c1"># Compute all pairs of entropy and mutual informations</span>
    <span class="n">dimension_max_temp</span> <span class="o">=</span> <span class="n">dimension_max</span> <span class="o">+</span> <span class="mi">0</span>
    <span class="n">dimension_max</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">allsubsets</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">n</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">combinations</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="n">ni</span><span class="p">)</span> <span class="k">for</span> <span class="n">ni</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dimension_max</span><span class="o">+</span><span class="mi">1</span><span class="p">)]))</span>
    <span class="n">list_tuples</span><span class="o">=</span><span class="n">allsubsets</span><span class="p">(</span><span class="n">dimension_tot</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">del</span> <span class="n">list_tuples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">dimension_max</span> <span class="o">!=</span> <span class="n">dimension_tot</span> <span class="p">:</span>
         <span class="n">tot_numb</span><span class="o">=</span><span class="mi">0</span>
         <span class="k">for</span>  <span class="n">xxx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">dimension_max</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">tot_numb</span><span class="o">=</span><span class="n">tot_numb</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_binomial</span><span class="p">(</span><span class="n">dimension_tot</span><span class="p">,</span><span class="n">xxx</span><span class="p">)</span>
    <span class="n">counter</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">tuple_var</span> <span class="ow">in</span> <span class="n">list_tuples</span><span class="p">:</span>
        <span class="n">counter</span><span class="o">=</span><span class="n">counter</span><span class="o">+</span><span class="mi">1</span>
        <span class="k">if</span> <span class="n">dimension_max</span> <span class="o">==</span> <span class="n">dimension_tot</span><span class="p">:</span>
             <span class="k">if</span> <span class="n">counter</span> <span class="o">%</span> <span class="nb">int</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">dimension_max</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                 <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;PROGRESS: at percent #</span><span class="si">%i</span><span class="s2">&quot;</span>  <span class="o">%</span> <span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">counter</span><span class="o">/</span><span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">dimension_max</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
             <span class="k">if</span> <span class="n">counter</span> <span class="o">%</span> <span class="nb">int</span><span class="p">(</span><span class="n">tot_numb</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                 <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;PROGRESS: at percent #</span><span class="si">%i</span><span class="s2">&quot;</span>  <span class="o">%</span> <span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">counter</span><span class="o">/</span><span class="n">tot_numb</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">tuple_var</span><span class="p">)):</span>
           <span class="k">if</span> <span class="n">x</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
               <span class="n">matrix_temp</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">data_mat</span><span class="p">[:,</span><span class="n">tuple_var</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">],(</span><span class="n">data_mat</span><span class="p">[:,</span><span class="n">tuple_var</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">))</span>
           <span class="k">else</span><span class="p">:</span>
               <span class="n">matrix_temp</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">matrix_temp</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">data_mat</span><span class="p">[:,</span><span class="n">tuple_var</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">],(</span><span class="n">data_mat</span><span class="p">[:,</span><span class="n">tuple_var</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">))),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">probability</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_probability</span><span class="p">(</span><span class="n">matrix_temp</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">probability</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">Nentropie</span><span class="p">[</span><span class="n">tuple_var</span><span class="p">]</span><span class="o">=</span><span class="n">Nentropie</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">tuple_var</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_information</span><span class="p">(</span><span class="n">probability</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
    <span class="n">Ninfomut</span><span class="o">=</span><span class="p">{}</span>
    <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">Nentropie</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">subset</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
                <span class="n">Ninfomut</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">=</span><span class="n">Ninfomut</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span> <span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">subset</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">Nentropie</span><span class="p">[</span><span class="n">subset</span><span class="p">]</span>

     <span class="c1"># find the pair of maximum information</span>
    <span class="n">max_info_temp</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">Ninfomut</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="p">:</span>
            <span class="k">if</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="n">max_info_temp</span><span class="p">:</span>
                <span class="n">max_info_temp</span> <span class="o">=</span> <span class="n">y</span>
                <span class="n">tuple_maxinfo</span> <span class="o">=</span> <span class="n">x</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The pair with Maximum mutual info is :&quot;</span><span class="p">,</span> <span class="n">tuple_maxinfo</span><span class="p">,</span><span class="s2">&quot; with info: &quot;</span><span class="p">,</span> <span class="n">max_info_temp</span><span class="p">)</span>

    <span class="c1"># Compute all k-uplets of maximum information</span>
    <span class="n">max_info_next</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">current_dim</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">while</span>  <span class="n">max_info_temp</span> <span class="o">&gt;</span>   <span class="n">max_info_next</span> <span class="p">:</span>
        <span class="n">max_info_temp</span> <span class="o">=</span> <span class="n">max_info_next</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DImension of the analysis &quot;</span><span class="p">,</span> <span class="n">current_dim</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">xxx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">dimension_tot</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">xxx</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tuple_maxinfo</span><span class="p">:</span>
                <span class="n">tuple_maxinfo</span><span class="o">=</span><span class="n">tuple_maxinfo</span> <span class="o">+</span> <span class="p">(</span><span class="n">xxx</span><span class="p">,)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tupple in computation &quot;</span><span class="p">,</span> <span class="n">tuple_maxinfo</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">tuple_maxinfo</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of variable added &quot;</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">subset</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="n">tuple_maxinfo</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;subset &quot;</span><span class="p">,</span> <span class="n">subset</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">subset</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">Nentropie</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;subset not in Nentropie &quot;</span><span class="p">,</span> <span class="n">subset</span><span class="p">)</span>
                            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">subset</span><span class="p">)):</span>
                                <span class="k">if</span> <span class="n">x</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                                    <span class="n">matrix_temp</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">data_mat</span><span class="p">[:,</span><span class="n">subset</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">],(</span><span class="n">data_mat</span><span class="p">[:,</span><span class="n">subset</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">))</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="n">matrix_temp</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">matrix_temp</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">data_mat</span><span class="p">[:,</span><span class="n">subset</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">],(</span><span class="n">data_mat</span><span class="p">[:,</span><span class="n">subset</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">))),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                            <span class="n">probability</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_probability</span><span class="p">(</span><span class="n">matrix_temp</span><span class="p">)</span>
                            <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">probability</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                                <span class="n">Nentropie</span><span class="p">[</span><span class="n">subset</span><span class="p">]</span><span class="o">=</span><span class="n">Nentropie</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">subset</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_information</span><span class="p">(</span><span class="n">probability</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
                        <span class="n">Ninfomut</span><span class="p">[</span><span class="n">tuple_maxinfo</span><span class="p">]</span><span class="o">=</span><span class="n">Ninfomut</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">tuple_maxinfo</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span> <span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">subset</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">Nentropie</span><span class="p">[</span><span class="n">subset</span><span class="p">]</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Ninfomut of &quot;</span><span class="p">,</span><span class="n">tuple_maxinfo</span><span class="p">,</span><span class="s2">&quot; is &quot;</span><span class="p">,</span> <span class="n">Ninfomut</span><span class="p">[</span><span class="n">tuple_maxinfo</span><span class="p">])</span>
        <span class="n">max_info_next</span> <span class="o">=-</span><span class="mi">100000</span>
        <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="n">Ninfomut</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">==</span> <span class="n">current_dim</span> <span class="p">:</span>
                <span class="k">if</span> <span class="n">b</span> <span class="o">&gt;</span> <span class="n">max_info_next</span><span class="p">:</span>
                    <span class="n">max_info_next</span> <span class="o">=</span> <span class="n">b</span>
                    <span class="n">tuple_maxinfo</span> <span class="o">=</span> <span class="n">a</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The &quot;</span><span class="p">,</span> <span class="n">current_dim</span><span class="p">,</span><span class="s2">&quot;-tuple with Maximum mutual info is :&quot;</span><span class="p">,</span> <span class="n">tuple_maxinfo</span><span class="p">,</span><span class="s2">&quot; with info: &quot;</span><span class="p">,</span><span class="n">max_info_next</span><span class="p">)</span>
        <span class="n">current_dim</span> <span class="o">=</span> <span class="n">current_dim</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="k">return</span>  <span class="n">Nentropie</span><span class="p">,</span> <span class="n">Ninfomut</span>
</pre></div>

    </div>
      
  </div>
</div>
    <hr>
    <footer>
        <br>
        <div class="container">
            <ul class="list-inline">
                <li style="font-weight:bold"><a href="../../genindex.html">Index</a></li>
                <li>·</li>
                <li style="font-weight:bold"><a href="https://github.com/pierrebaudot/infotopopy">Github</a></li>
                <li>·</li>
                <li style="font-weight:bold"><a href="../../references.html">References</a></li>
            </ul>
         </div>
        <!-- <br> -->
        <p>&copy; Copyright 2020, Pierre Baudot.</p>
    </footer>

  </body>
</html>